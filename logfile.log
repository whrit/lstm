2024-04-16 16:20:59,061 - INFO - Starting script execution.
2024-04-16 16:20:59,061 - INFO - TensorFlow Version: 2.16.1
2024-04-16 16:20:59,061 - INFO - Fetching stock_data data...
2024-04-16 16:20:59,062 - DEBUG - Entering download()
2024-04-16 16:20:59,062 - DEBUG - Disabling multithreading because DEBUG logging enabled
2024-04-16 16:20:59,062 - DEBUG -  Entering history()
2024-04-16 16:20:59,064 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_kv" ("key" VARCHAR(255) NOT NULL PRIMARY KEY, "value" VARCHAR(255)) WITHOUT ROWID', [])
2024-04-16 16:20:59,065 - DEBUG - ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['AAPL', 1, 0])
2024-04-16 16:20:59,107 - DEBUG -   Entering history()
2024-04-16 16:20:59,110 - DEBUG - AAPL: Yahoo GET parameters: {'period1': '2020-01-01 00:00:00-05:00', 'period2': '2024-01-01 00:00:00-05:00', 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'}
2024-04-16 16:20:59,111 - DEBUG -    Entering get()
2024-04-16 16:20:59,111 - DEBUG - url=https://query2.finance.yahoo.com/v8/finance/chart/AAPL
2024-04-16 16:20:59,111 - DEBUG - params=frozendict.frozendict({'period1': 1577854800, 'period2': 1704085200, 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'})
2024-04-16 16:20:59,111 - DEBUG -     Entering _get_cookie_and_crumb()
2024-04-16 16:20:59,111 - DEBUG - cookie_mode = 'basic'
2024-04-16 16:20:59,112 - DEBUG -      Entering _get_cookie_and_crumb_basic()
2024-04-16 16:20:59,113 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_cookieschema" ("strategy" VARCHAR(255) NOT NULL PRIMARY KEY, "fetch_date" DATETIME NOT NULL, "cookie_bytes" BLOB NOT NULL) WITHOUT ROWID', [])
2024-04-16 16:20:59,113 - DEBUG - ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2024-04-16 16:20:59,114 - DEBUG - loaded persistent cookie
2024-04-16 16:20:59,114 - DEBUG - reusing cookie
2024-04-16 16:20:59,160 - DEBUG - Starting new HTTPS connection (1): query1.finance.yahoo.com:443
2024-04-16 16:20:59,220 - DEBUG - https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2024-04-16 16:20:59,221 - DEBUG - crumb = '2ylVJsw6yG2'
2024-04-16 16:20:59,221 - DEBUG -      Exiting _get_cookie_and_crumb_basic()
2024-04-16 16:20:59,221 - DEBUG -     Exiting _get_cookie_and_crumb()
2024-04-16 16:20:59,225 - DEBUG - Starting new HTTPS connection (1): query2.finance.yahoo.com:443
2024-04-16 16:20:59,338 - DEBUG - https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/AAPL?period1=1577854800&period2=1704085200&interval=1d&includePrePost=False&events=div%2Csplits%2CcapitalGains&crumb=2ylVJsw6yG2 HTTP/1.1" 200 None
2024-04-16 16:20:59,355 - DEBUG - response code=200
2024-04-16 16:20:59,355 - DEBUG -    Exiting get()
2024-04-16 16:20:59,363 - DEBUG - AAPL: yfinance received OHLC data: 2020-01-02 14:30:00 -> 2023-12-29 14:30:00
2024-04-16 16:20:59,366 - DEBUG - AAPL: OHLC after cleaning: 2020-01-02 09:30:00-05:00 -> 2023-12-29 09:30:00-05:00
2024-04-16 16:20:59,398 - DEBUG - AAPL: OHLC after combining events: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 16:20:59,404 - DEBUG - AAPL: yfinance returning OHLC: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 16:20:59,405 - DEBUG -   Exiting history()
2024-04-16 16:20:59,405 - DEBUG -  Exiting history()
2024-04-16 16:20:59,405 - DEBUG - Exiting download()
2024-04-16 16:20:59,405 - INFO - Swapping 'Adj Close' data into 'Close' column...
2024-04-16 16:20:59,406 - INFO - Removing 'Adj Close' column...
2024-04-16 16:20:59,406 - INFO - First few rows of the dataframe:
2024-04-16 16:20:59,407 - INFO -                  Open       High        Low      Close     Volume
Date                                                             
2020-01-02  74.059998  75.150002  73.797501  73.059433  135480400
2020-01-03  74.287498  75.144997  74.125000  72.349136  146322800
2020-01-06  73.447502  74.989998  73.187500  72.925613  118387200
2020-01-07  74.959999  75.224998  74.370003  72.582657  108872000
2020-01-08  74.290001  76.110001  74.290001  73.750252  132079200
2024-04-16 16:20:59,414 - INFO - Checking for missing values...
2024-04-16 16:20:59,414 - INFO - Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
2024-04-16 16:20:59,415 - INFO - Filling missing values, if any...
2024-04-16 16:20:59,416 - INFO - Calculating technical indicators...
2024-04-16 16:20:59,426 - INFO - Checking for NaN values after calculating technical indicators...
2024-04-16 16:20:59,427 - INFO - Open              0
High              0
Low               0
Close             0
Volume            0
SMA_10            9
SMA_50           49
EMA_20           19
RSI              14
STOCH_K          17
STOCH_D          17
MACD             33
MACDSIGNAL       33
MACDHIST         33
ADX              27
OBV               0
ATR              14
BBANDS_UPPER     19
BBANDS_MIDDLE    19
BBANDS_LOWER     19
MOM              10
CCI              13
WILLR            13
TSF              13
TRIX             88
ULTOSC           28
ROC              10
PLUS_DI          14
MINUS_DI         14
PLUS_DM          13
MINUS_DM         13
dtype: int64
2024-04-16 16:20:59,428 - INFO - Forward-filling NaN values...
2024-04-16 16:20:59,429 - INFO - Performing correlation analysis...
2024-04-16 16:20:59,434 - INFO - Correlation Matrix:
                  Close    Volume    SMA_10  ...  MINUS_DI   PLUS_DM  MINUS_DM
Close          1.000000 -0.556960  0.987863  ...  0.133783  0.188009 -0.003261
Volume        -0.556960  1.000000 -0.553656  ... -0.062147  0.226621  0.129785
SMA_10         0.987863 -0.553656  1.000000  ...  0.231659  0.113133  0.083568
SMA_50         0.940518 -0.564787  0.960735  ...  0.421796  0.009269  0.272974
EMA_20         0.981609 -0.557995  0.996117  ...  0.291564  0.080589  0.141583
RSI            0.030978  0.046877 -0.089781  ... -0.897301  0.480139 -0.818051
STOCH_K        0.190154 -0.093407  0.071923  ... -0.638927  0.511783 -0.578090
STOCH_D        0.194849 -0.081934  0.095800  ... -0.629684  0.491952 -0.580167
MACD           0.084122  0.076523  0.019574  ... -0.814082  0.458900 -0.778823
MACDSIGNAL     0.072951  0.108869  0.045970  ... -0.699396  0.339619 -0.683674
MACDHIST       0.050137 -0.078290 -0.072848  ... -0.504378  0.443557 -0.440066
ADX            0.083597  0.177829  0.064402  ... -0.386165  0.147314 -0.395610
OBV            0.747800 -0.318972  0.728020  ...  0.049478  0.277489 -0.003349
ATR           -0.206290  0.434361 -0.186273  ...  0.370548  0.443536  0.685009
BBANDS_UPPER   0.967553 -0.514344  0.986220  ...  0.335402  0.118290  0.203381
BBANDS_MIDDLE  0.974566 -0.551469  0.993160  ...  0.310158  0.062538  0.158342
BBANDS_LOWER   0.967618 -0.581948  0.985864  ...  0.279433  0.003765  0.109289
MOM            0.067148 -0.002646 -0.063443  ... -0.700528  0.498328 -0.632279
CCI            0.027230 -0.010088 -0.110643  ... -0.728646  0.421371 -0.654291
WILLR          0.179111 -0.098426  0.046120  ... -0.604914  0.494691 -0.538150
TSF            0.993352 -0.551086  0.989063  ...  0.124772  0.186557 -0.013585
TRIX          -0.168298  0.401657 -0.164337  ... -0.395388  0.067017 -0.342707
ULTOSC         0.513720 -0.235504  0.430679  ... -0.108214  0.496215 -0.144546
ROC           -0.027869  0.074886 -0.155270  ... -0.705479  0.480797 -0.635385
PLUS_DI        0.382258 -0.072356  0.292117  ... -0.524263  0.760843 -0.502453
MINUS_DI       0.133783 -0.062147  0.231659  ...  1.000000 -0.274478  0.917048
PLUS_DM        0.188009  0.226621  0.113133  ... -0.274478  1.000000 -0.061485
MINUS_DM      -0.003261  0.129785  0.083568  ...  0.917048 -0.061485  1.000000

[28 rows x 28 columns]
2024-04-16 16:20:59,470 - INFO - Selecting features based on correlation with the target variable...
2024-04-16 16:20:59,477 - INFO - Selected Features (Correlation): ['Volume', 'SMA_10', 'SMA_50', 'EMA_20', 'OBV', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'ULTOSC']
2024-04-16 16:20:59,477 - INFO - Performing recursive feature elimination...
2024-04-16 16:20:59,521 - INFO - Selected Features (RFE): ['SMA_10', 'SMA_50', 'MACD', 'MACDSIGNAL', 'MACDHIST', 'ATR', 'BBANDS_MIDDLE', 'TSF', 'TRIX', 'MINUS_DM']
2024-04-16 16:20:59,522 - INFO - Updating selected features based on feature selection results...
2024-04-16 16:20:59,522 - INFO - Final Selected Features: ['OBV', 'SMA_10', 'ULTOSC', 'BBANDS_LOWER', 'Close', 'SMA_50', 'BBANDS_MIDDLE', 'TSF', 'ATR', 'MINUS_DM', 'Volume', 'MACDSIGNAL', 'EMA_20', 'BBANDS_UPPER', 'TRIX', 'MACDHIST', 'MACD']
2024-04-16 16:20:59,522 - INFO - Feature Importances (SelectKBest):
2024-04-16 16:20:59,522 - INFO - Volume: 411.92985581050687
2024-04-16 16:20:59,523 - INFO - SMA_10: 37048.73530963381
2024-04-16 16:20:59,523 - INFO - SMA_50: 7019.783798379234
2024-04-16 16:20:59,523 - INFO - EMA_20: 24218.38447917105
2024-04-16 16:20:59,523 - INFO - OBV: 0.8798890649696065
2024-04-16 16:20:59,523 - INFO - BBANDS_UPPER: 34.3637264674977
2024-04-16 16:20:59,523 - INFO - BBANDS_MIDDLE: 36.14956698921748
2024-04-16 16:20:59,523 - INFO - BBANDS_LOWER: 6.528341212449624
2024-04-16 16:20:59,523 - INFO - TSF: 4.900958055804416
2024-04-16 16:20:59,523 - INFO - ULTOSC: 2.3083964012395204
2024-04-16 16:20:59,523 - INFO - Feature Importances (RFE):
2024-04-16 16:20:59,523 - INFO - SMA_10: 17
2024-04-16 16:20:59,523 - INFO - SMA_50: 1
2024-04-16 16:20:59,524 - INFO - MACD: 1
2024-04-16 16:20:59,524 - INFO - MACDSIGNAL: 2
2024-04-16 16:20:59,524 - INFO - MACDHIST: 4
2024-04-16 16:20:59,524 - INFO - ATR: 10
2024-04-16 16:20:59,524 - INFO - BBANDS_MIDDLE: 16
2024-04-16 16:20:59,524 - INFO - TSF: 1
2024-04-16 16:20:59,524 - INFO - TRIX: 1
2024-04-16 16:20:59,524 - INFO - MINUS_DM: 1
2024-04-16 16:20:59,524 - INFO - Defining the scaler...
2024-04-16 16:20:59,524 - INFO - Scaling the selected features...
2024-04-16 16:20:59,533 - INFO - Preparing the data for training...
2024-04-16 16:20:59,549 - INFO - Performing hyperparameter tuning...
2024-04-16 17:03:26,845 - INFO - Starting script execution.
2024-04-16 17:03:26,846 - INFO - TensorFlow Version: 2.16.1
2024-04-16 17:03:26,847 - INFO - Fetching stock_data data...
2024-04-16 17:03:26,847 - DEBUG - Entering download()
2024-04-16 17:03:26,847 - DEBUG - Disabling multithreading because DEBUG logging enabled
2024-04-16 17:03:26,847 - DEBUG -  Entering history()
2024-04-16 17:03:26,870 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_kv" ("key" VARCHAR(255) NOT NULL PRIMARY KEY, "value" VARCHAR(255)) WITHOUT ROWID', [])
2024-04-16 17:03:26,870 - DEBUG - ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['AAPL', 1, 0])
2024-04-16 17:03:26,916 - DEBUG -   Entering history()
2024-04-16 17:03:26,927 - DEBUG - AAPL: Yahoo GET parameters: {'period1': '2020-01-01 00:00:00-05:00', 'period2': '2024-01-01 00:00:00-05:00', 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'}
2024-04-16 17:03:26,934 - DEBUG -    Entering get()
2024-04-16 17:03:26,934 - DEBUG - url=https://query2.finance.yahoo.com/v8/finance/chart/AAPL
2024-04-16 17:03:26,934 - DEBUG - params=frozendict.frozendict({'period1': 1577854800, 'period2': 1704085200, 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'})
2024-04-16 17:03:26,934 - DEBUG -     Entering _get_cookie_and_crumb()
2024-04-16 17:03:26,934 - DEBUG - cookie_mode = 'basic'
2024-04-16 17:03:26,934 - DEBUG -      Entering _get_cookie_and_crumb_basic()
2024-04-16 17:03:26,937 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_cookieschema" ("strategy" VARCHAR(255) NOT NULL PRIMARY KEY, "fetch_date" DATETIME NOT NULL, "cookie_bytes" BLOB NOT NULL) WITHOUT ROWID', [])
2024-04-16 17:03:26,937 - DEBUG - ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2024-04-16 17:03:26,938 - DEBUG - loaded persistent cookie
2024-04-16 17:03:26,939 - DEBUG - reusing cookie
2024-04-16 17:03:26,989 - DEBUG - Starting new HTTPS connection (1): query1.finance.yahoo.com:443
2024-04-16 17:03:27,193 - DEBUG - https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2024-04-16 17:03:27,193 - DEBUG - crumb = '2ylVJsw6yG2'
2024-04-16 17:03:27,193 - DEBUG -      Exiting _get_cookie_and_crumb_basic()
2024-04-16 17:03:27,193 - DEBUG -     Exiting _get_cookie_and_crumb()
2024-04-16 17:03:27,207 - DEBUG - Starting new HTTPS connection (1): query2.finance.yahoo.com:443
2024-04-16 17:03:27,681 - DEBUG - https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/AAPL?period1=1577854800&period2=1704085200&interval=1d&includePrePost=False&events=div%2Csplits%2CcapitalGains&crumb=2ylVJsw6yG2 HTTP/1.1" 200 None
2024-04-16 17:03:27,688 - DEBUG - response code=200
2024-04-16 17:03:27,688 - DEBUG -    Exiting get()
2024-04-16 17:03:27,710 - DEBUG - AAPL: yfinance received OHLC data: 2020-01-02 14:30:00 -> 2023-12-29 14:30:00
2024-04-16 17:03:27,721 - DEBUG - AAPL: OHLC after cleaning: 2020-01-02 09:30:00-05:00 -> 2023-12-29 09:30:00-05:00
2024-04-16 17:03:27,766 - DEBUG - AAPL: OHLC after combining events: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:03:27,769 - DEBUG - AAPL: yfinance returning OHLC: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:03:27,769 - DEBUG -   Exiting history()
2024-04-16 17:03:27,769 - DEBUG -  Exiting history()
2024-04-16 17:03:27,770 - DEBUG - Exiting download()
2024-04-16 17:03:27,770 - INFO - Swapping 'Adj Close' data into 'Close' column...
2024-04-16 17:03:27,771 - INFO - Removing 'Adj Close' column...
2024-04-16 17:03:27,772 - INFO - First few rows of the dataframe:
2024-04-16 17:03:27,772 - INFO -                  Open       High        Low      Close     Volume
Date                                                             
2020-01-02  74.059998  75.150002  73.797501  73.059425  135480400
2020-01-03  74.287498  75.144997  74.125000  72.349136  146322800
2020-01-06  73.447502  74.989998  73.187500  72.925621  118387200
2020-01-07  74.959999  75.224998  74.370003  72.582657  108872000
2020-01-08  74.290001  76.110001  74.290001  73.750244  132079200
2024-04-16 17:03:27,782 - INFO - Checking for missing values...
2024-04-16 17:03:27,783 - INFO - Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
2024-04-16 17:03:27,783 - INFO - Filling missing values, if any...
2024-04-16 17:03:27,784 - INFO - Calculating technical indicators...
2024-04-16 17:03:27,800 - INFO - Checking for NaN values after calculating technical indicators...
2024-04-16 17:03:27,801 - INFO - Open              0
High              0
Low               0
Close             0
Volume            0
SMA_10            9
SMA_50           49
EMA_20           19
RSI              14
STOCH_K          17
STOCH_D          17
MACD             33
MACDSIGNAL       33
MACDHIST         33
ADX              27
OBV               0
ATR              14
BBANDS_UPPER     19
BBANDS_MIDDLE    19
BBANDS_LOWER     19
MOM              10
CCI              13
WILLR            13
TSF              13
TRIX             88
ULTOSC           28
ROC              10
PLUS_DI          14
MINUS_DI         14
PLUS_DM          13
MINUS_DM         13
dtype: int64
2024-04-16 17:03:27,801 - INFO - Forward-filling NaN values...
2024-04-16 17:03:27,803 - INFO - Performing correlation analysis...
2024-04-16 17:03:27,807 - INFO - Correlation Matrix:
                  Close    Volume    SMA_10  ...  MINUS_DI   PLUS_DM  MINUS_DM
Close          1.000000 -0.556960  0.987863  ...  0.133784  0.188009 -0.003261
Volume        -0.556960  1.000000 -0.553656  ... -0.062147  0.226621  0.129785
SMA_10         0.987863 -0.553656  1.000000  ...  0.231659  0.113133  0.083568
SMA_50         0.940518 -0.564787  0.960735  ...  0.421796  0.009269  0.272974
EMA_20         0.981609 -0.557995  0.996117  ...  0.291564  0.080589  0.141583
RSI            0.030978  0.046877 -0.089781  ... -0.897301  0.480139 -0.818051
STOCH_K        0.190154 -0.093407  0.071923  ... -0.638927  0.511783 -0.578090
STOCH_D        0.194849 -0.081934  0.095800  ... -0.629684  0.491952 -0.580167
MACD           0.084122  0.076523  0.019574  ... -0.814082  0.458900 -0.778823
MACDSIGNAL     0.072951  0.108869  0.045970  ... -0.699396  0.339619 -0.683674
MACDHIST       0.050137 -0.078290 -0.072848  ... -0.504378  0.443557 -0.440066
ADX            0.083597  0.177829  0.064402  ... -0.386165  0.147314 -0.395610
OBV            0.747800 -0.318972  0.728020  ...  0.049478  0.277489 -0.003349
ATR           -0.206290  0.434361 -0.186273  ...  0.370549  0.443536  0.685009
BBANDS_UPPER   0.967553 -0.514344  0.986220  ...  0.335402  0.118290  0.203381
BBANDS_MIDDLE  0.974566 -0.551469  0.993160  ...  0.310158  0.062538  0.158342
BBANDS_LOWER   0.967618 -0.581948  0.985864  ...  0.279433  0.003766  0.109289
MOM            0.067148 -0.002646 -0.063443  ... -0.700528  0.498327 -0.632279
CCI            0.027230 -0.010089 -0.110643  ... -0.728646  0.421371 -0.654291
WILLR          0.179111 -0.098426  0.046120  ... -0.604914  0.494691 -0.538150
TSF            0.993352 -0.551086  0.989063  ...  0.124772  0.186557 -0.013585
TRIX          -0.168298  0.401657 -0.164337  ... -0.395388  0.067017 -0.342707
ULTOSC         0.513720 -0.235504  0.430679  ... -0.108214  0.496215 -0.144546
ROC           -0.027869  0.074886 -0.155270  ... -0.705479  0.480797 -0.635385
PLUS_DI        0.382257 -0.072355  0.292117  ... -0.524263  0.760843 -0.502453
MINUS_DI       0.133784 -0.062147  0.231659  ...  1.000000 -0.274478  0.917048
PLUS_DM        0.188009  0.226621  0.113133  ... -0.274478  1.000000 -0.061485
MINUS_DM      -0.003261  0.129785  0.083568  ...  0.917048 -0.061485  1.000000

[28 rows x 28 columns]
2024-04-16 17:03:27,831 - INFO - Selecting features based on correlation with the target variable...
2024-04-16 17:03:27,847 - INFO - Selected Features (Correlation): ['Volume', 'SMA_10', 'SMA_50', 'EMA_20', 'OBV', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'ULTOSC']
2024-04-16 17:03:27,847 - INFO - Performing recursive feature elimination...
2024-04-16 17:03:27,895 - INFO - Selected Features (RFE): ['SMA_10', 'SMA_50', 'MACD', 'MACDSIGNAL', 'MACDHIST', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'TRIX']
2024-04-16 17:03:27,895 - INFO - Updating selected features based on feature selection results...
2024-04-16 17:03:27,896 - INFO - Final Selected Features: ['TSF', 'Volume', 'BBANDS_MIDDLE', 'MACDSIGNAL', 'SMA_10', 'Close', 'ULTOSC', 'EMA_20', 'TRIX', 'OBV', 'SMA_50', 'MACDHIST', 'MACD', 'BBANDS_UPPER', 'BBANDS_LOWER']
2024-04-16 17:03:27,896 - INFO - Feature Importances (SelectKBest):
2024-04-16 17:03:27,896 - INFO - Volume: 411.9298801678665
2024-04-16 17:03:27,896 - INFO - SMA_10: 37048.74366954377
2024-04-16 17:03:27,897 - INFO - SMA_50: 7019.785908765222
2024-04-16 17:03:27,897 - INFO - EMA_20: 24218.390967326508
2024-04-16 17:03:27,897 - INFO - OBV: 0.8798782255789284
2024-04-16 17:03:27,897 - INFO - BBANDS_UPPER: 34.36368747268718
2024-04-16 17:03:27,897 - INFO - BBANDS_MIDDLE: 36.14952744740572
2024-04-16 17:03:27,897 - INFO - BBANDS_LOWER: 6.528326609654423
2024-04-16 17:03:27,897 - INFO - TSF: 4.900945055359536
2024-04-16 17:03:27,897 - INFO - ULTOSC: 2.308395422491333
2024-04-16 17:03:27,897 - INFO - Feature Importances (RFE):
2024-04-16 17:03:27,897 - INFO - SMA_10: 17
2024-04-16 17:03:27,897 - INFO - SMA_50: 1
2024-04-16 17:03:27,897 - INFO - MACD: 1
2024-04-16 17:03:27,897 - INFO - MACDSIGNAL: 4
2024-04-16 17:03:27,897 - INFO - MACDHIST: 6
2024-04-16 17:03:27,897 - INFO - BBANDS_UPPER: 10
2024-04-16 17:03:27,897 - INFO - BBANDS_MIDDLE: 16
2024-04-16 17:03:27,898 - INFO - BBANDS_LOWER: 1
2024-04-16 17:03:27,898 - INFO - TSF: 1
2024-04-16 17:03:27,898 - INFO - TRIX: 1
2024-04-16 17:03:27,898 - INFO - Defining the scaler...
2024-04-16 17:03:27,898 - INFO - Scaling the selected features...
2024-04-16 17:03:27,904 - INFO - Preparing the data for training...
2024-04-16 17:03:27,911 - INFO - Performing hyperparameter tuning...
2024-04-16 17:09:09,526 - INFO - Starting script execution.
2024-04-16 17:09:09,527 - INFO - TensorFlow Version: 2.16.1
2024-04-16 17:09:09,527 - INFO - Fetching stock_data data...
2024-04-16 17:09:09,528 - DEBUG - Entering download()
2024-04-16 17:09:09,528 - DEBUG - Disabling multithreading because DEBUG logging enabled
2024-04-16 17:09:09,530 - DEBUG -  Entering history()
2024-04-16 17:09:09,550 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_kv" ("key" VARCHAR(255) NOT NULL PRIMARY KEY, "value" VARCHAR(255)) WITHOUT ROWID', [])
2024-04-16 17:09:09,551 - DEBUG - ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['AAPL', 1, 0])
2024-04-16 17:09:09,723 - DEBUG -   Entering history()
2024-04-16 17:09:09,761 - DEBUG - AAPL: Yahoo GET parameters: {'period1': '2020-01-01 00:00:00-05:00', 'period2': '2024-01-01 00:00:00-05:00', 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'}
2024-04-16 17:09:09,802 - DEBUG -    Entering get()
2024-04-16 17:09:09,802 - DEBUG - url=https://query2.finance.yahoo.com/v8/finance/chart/AAPL
2024-04-16 17:09:09,802 - DEBUG - params=frozendict.frozendict({'period1': 1577854800, 'period2': 1704085200, 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'})
2024-04-16 17:09:09,803 - DEBUG -     Entering _get_cookie_and_crumb()
2024-04-16 17:09:09,803 - DEBUG - cookie_mode = 'basic'
2024-04-16 17:09:09,803 - DEBUG -      Entering _get_cookie_and_crumb_basic()
2024-04-16 17:09:09,812 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_cookieschema" ("strategy" VARCHAR(255) NOT NULL PRIMARY KEY, "fetch_date" DATETIME NOT NULL, "cookie_bytes" BLOB NOT NULL) WITHOUT ROWID', [])
2024-04-16 17:09:09,818 - DEBUG - ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2024-04-16 17:09:09,822 - DEBUG - loaded persistent cookie
2024-04-16 17:09:09,824 - DEBUG - reusing cookie
2024-04-16 17:09:10,036 - DEBUG - Starting new HTTPS connection (1): query1.finance.yahoo.com:443
2024-04-16 17:09:10,165 - DEBUG - https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2024-04-16 17:09:10,166 - DEBUG - crumb = '2ylVJsw6yG2'
2024-04-16 17:09:10,167 - DEBUG -      Exiting _get_cookie_and_crumb_basic()
2024-04-16 17:09:10,167 - DEBUG -     Exiting _get_cookie_and_crumb()
2024-04-16 17:09:10,179 - DEBUG - Starting new HTTPS connection (1): query2.finance.yahoo.com:443
2024-04-16 17:09:10,347 - DEBUG - https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/AAPL?period1=1577854800&period2=1704085200&interval=1d&includePrePost=False&events=div%2Csplits%2CcapitalGains&crumb=2ylVJsw6yG2 HTTP/1.1" 200 None
2024-04-16 17:09:10,373 - DEBUG - response code=200
2024-04-16 17:09:10,373 - DEBUG -    Exiting get()
2024-04-16 17:09:10,450 - DEBUG - AAPL: yfinance received OHLC data: 2020-01-02 14:30:00 -> 2023-12-29 14:30:00
2024-04-16 17:09:10,479 - DEBUG - AAPL: OHLC after cleaning: 2020-01-02 09:30:00-05:00 -> 2023-12-29 09:30:00-05:00
2024-04-16 17:09:10,612 - DEBUG - AAPL: OHLC after combining events: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:09:10,625 - DEBUG - AAPL: yfinance returning OHLC: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:09:10,626 - DEBUG -   Exiting history()
2024-04-16 17:09:10,626 - DEBUG -  Exiting history()
2024-04-16 17:09:10,627 - DEBUG - Exiting download()
2024-04-16 17:09:10,627 - INFO - Swapping 'Adj Close' data into 'Close' column...
2024-04-16 17:09:10,628 - INFO - Removing 'Adj Close' column...
2024-04-16 17:09:10,631 - INFO - First few rows of the dataframe:
2024-04-16 17:09:10,632 - INFO -                  Open       High        Low      Close     Volume
Date                                                             
2020-01-02  74.059998  75.150002  73.797501  73.059441  135480400
2020-01-03  74.287498  75.144997  74.125000  72.349144  146322800
2020-01-06  73.447502  74.989998  73.187500  72.925621  118387200
2020-01-07  74.959999  75.224998  74.370003  72.582664  108872000
2020-01-08  74.290001  76.110001  74.290001  73.750259  132079200
2024-04-16 17:09:10,734 - INFO - Checking for missing values...
2024-04-16 17:09:10,736 - INFO - Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
2024-04-16 17:09:10,743 - INFO - Filling missing values, if any...
2024-04-16 17:09:10,746 - INFO - Calculating technical indicators...
2024-04-16 17:09:10,821 - INFO - Checking for NaN values after calculating technical indicators...
2024-04-16 17:09:10,827 - INFO - Open              0
High              0
Low               0
Close             0
Volume            0
SMA_10            9
SMA_50           49
EMA_20           19
RSI              14
STOCH_K          17
STOCH_D          17
MACD             33
MACDSIGNAL       33
MACDHIST         33
ADX              27
OBV               0
ATR              14
BBANDS_UPPER     19
BBANDS_MIDDLE    19
BBANDS_LOWER     19
MOM              10
CCI              13
WILLR            13
TSF              13
TRIX             88
ULTOSC           28
ROC              10
PLUS_DI          14
MINUS_DI         14
PLUS_DM          13
MINUS_DM         13
dtype: int64
2024-04-16 17:09:10,829 - INFO - Forward-filling NaN values...
2024-04-16 17:09:10,836 - INFO - Performing correlation analysis...
2024-04-16 17:09:10,853 - INFO - Correlation Matrix:
                  Close    Volume    SMA_10  ...  MINUS_DI   PLUS_DM  MINUS_DM
Close          1.000000 -0.556960  0.987863  ...  0.133784  0.188009 -0.003261
Volume        -0.556960  1.000000 -0.553656  ... -0.062147  0.226621  0.129785
SMA_10         0.987863 -0.553656  1.000000  ...  0.231659  0.113133  0.083568
SMA_50         0.940518 -0.564787  0.960735  ...  0.421796  0.009269  0.272974
EMA_20         0.981609 -0.557995  0.996117  ...  0.291564  0.080589  0.141583
RSI            0.030978  0.046877 -0.089781  ... -0.897301  0.480139 -0.818051
STOCH_K        0.190154 -0.093407  0.071923  ... -0.638926  0.511783 -0.578090
STOCH_D        0.194849 -0.081934  0.095800  ... -0.629684  0.491952 -0.580167
MACD           0.084122  0.076523  0.019574  ... -0.814082  0.458900 -0.778823
MACDSIGNAL     0.072951  0.108869  0.045970  ... -0.699396  0.339619 -0.683674
MACDHIST       0.050137 -0.078290 -0.072848  ... -0.504378  0.443557 -0.440066
ADX            0.083597  0.177829  0.064402  ... -0.386165  0.147314 -0.395610
OBV            0.747800 -0.318972  0.728020  ...  0.049478  0.277489 -0.003349
ATR           -0.206290  0.434361 -0.186274  ...  0.370549  0.443536  0.685009
BBANDS_UPPER   0.967553 -0.514344  0.986220  ...  0.335402  0.118291  0.203381
BBANDS_MIDDLE  0.974566 -0.551469  0.993160  ...  0.310158  0.062538  0.158342
BBANDS_LOWER   0.967618 -0.581948  0.985864  ...  0.279433  0.003766  0.109289
MOM            0.067148 -0.002646 -0.063443  ... -0.700528  0.498327 -0.632279
CCI            0.027230 -0.010088 -0.110643  ... -0.728646  0.421371 -0.654291
WILLR          0.179111 -0.098426  0.046121  ... -0.604914  0.494691 -0.538150
TSF            0.993352 -0.551086  0.989063  ...  0.124772  0.186557 -0.013585
TRIX          -0.168297  0.401657 -0.164337  ... -0.395388  0.067017 -0.342707
ULTOSC         0.513720 -0.235504  0.430679  ... -0.108213  0.496215 -0.144546
ROC           -0.027869  0.074886 -0.155270  ... -0.705479  0.480797 -0.635385
PLUS_DI        0.382258 -0.072356  0.292117  ... -0.524262  0.760843 -0.502453
MINUS_DI       0.133784 -0.062147  0.231659  ...  1.000000 -0.274478  0.917048
PLUS_DM        0.188009  0.226621  0.113133  ... -0.274478  1.000000 -0.061485
MINUS_DM      -0.003261  0.129785  0.083568  ...  0.917048 -0.061485  1.000000

[28 rows x 28 columns]
2024-04-16 17:09:10,981 - INFO - Selecting features based on correlation with the target variable...
2024-04-16 17:09:11,022 - INFO - Selected Features (Correlation): ['Volume', 'SMA_10', 'SMA_50', 'EMA_20', 'OBV', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'ULTOSC']
2024-04-16 17:09:11,024 - INFO - Performing recursive feature elimination...
2024-04-16 17:09:11,183 - INFO - Selected Features (RFE): ['SMA_10', 'SMA_50', 'MACD', 'MACDSIGNAL', 'MACDHIST', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'TRIX']
2024-04-16 17:09:11,184 - INFO - Updating selected features based on feature selection results...
2024-04-16 17:09:11,184 - INFO - Final Selected Features: ['ULTOSC', 'BBANDS_MIDDLE', 'OBV', 'TRIX', 'TSF', 'Volume', 'Close', 'BBANDS_LOWER', 'MACDHIST', 'SMA_10', 'MACDSIGNAL', 'EMA_20', 'BBANDS_UPPER', 'MACD', 'SMA_50']
2024-04-16 17:09:11,184 - INFO - Feature Importances (SelectKBest):
2024-04-16 17:09:11,185 - INFO - Volume: 411.9298716216457
2024-04-16 17:09:11,185 - INFO - SMA_10: 37048.74135076755
2024-04-16 17:09:11,186 - INFO - SMA_50: 7019.785068180632
2024-04-16 17:09:11,186 - INFO - EMA_20: 24218.389532075616
2024-04-16 17:09:11,186 - INFO - OBV: 0.8798508550909349
2024-04-16 17:09:11,186 - INFO - BBANDS_UPPER: 34.36373831235632
2024-04-16 17:09:11,186 - INFO - BBANDS_MIDDLE: 36.14957953159825
2024-04-16 17:09:11,186 - INFO - BBANDS_LOWER: 6.528333894939648
2024-04-16 17:09:11,186 - INFO - TSF: 4.9009518925974795
2024-04-16 17:09:11,189 - INFO - ULTOSC: 2.3083952945983404
2024-04-16 17:09:11,190 - INFO - Feature Importances (RFE):
2024-04-16 17:09:11,191 - INFO - SMA_10: 17
2024-04-16 17:09:11,191 - INFO - SMA_50: 1
2024-04-16 17:09:11,191 - INFO - MACD: 1
2024-04-16 17:09:11,191 - INFO - MACDSIGNAL: 4
2024-04-16 17:09:11,191 - INFO - MACDHIST: 6
2024-04-16 17:09:11,191 - INFO - BBANDS_UPPER: 10
2024-04-16 17:09:11,191 - INFO - BBANDS_MIDDLE: 16
2024-04-16 17:09:11,192 - INFO - BBANDS_LOWER: 1
2024-04-16 17:09:11,192 - INFO - TSF: 1
2024-04-16 17:09:11,192 - INFO - TRIX: 1
2024-04-16 17:09:11,192 - INFO - Defining the scaler...
2024-04-16 17:09:11,192 - INFO - Scaling the selected features...
2024-04-16 17:09:11,208 - INFO - Preparing the data for training...
2024-04-16 17:09:11,227 - INFO - Performing hyperparameter tuning...
2024-04-16 17:16:55,003 - INFO - Starting script execution.
2024-04-16 17:16:55,004 - INFO - TensorFlow Version: 2.16.1
2024-04-16 17:16:55,004 - INFO - Fetching stock_data data...
2024-04-16 17:16:55,004 - DEBUG - Entering download()
2024-04-16 17:16:55,004 - DEBUG - Disabling multithreading because DEBUG logging enabled
2024-04-16 17:16:55,005 - DEBUG -  Entering history()
2024-04-16 17:16:55,024 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_kv" ("key" VARCHAR(255) NOT NULL PRIMARY KEY, "value" VARCHAR(255)) WITHOUT ROWID', [])
2024-04-16 17:16:55,025 - DEBUG - ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['AAPL', 1, 0])
2024-04-16 17:16:55,071 - DEBUG -   Entering history()
2024-04-16 17:16:55,082 - DEBUG - AAPL: Yahoo GET parameters: {'period1': '2020-01-01 00:00:00-05:00', 'period2': '2024-01-01 00:00:00-05:00', 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'}
2024-04-16 17:16:55,089 - DEBUG -    Entering get()
2024-04-16 17:16:55,089 - DEBUG - url=https://query2.finance.yahoo.com/v8/finance/chart/AAPL
2024-04-16 17:16:55,089 - DEBUG - params=frozendict.frozendict({'period1': 1577854800, 'period2': 1704085200, 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'})
2024-04-16 17:16:55,089 - DEBUG -     Entering _get_cookie_and_crumb()
2024-04-16 17:16:55,089 - DEBUG - cookie_mode = 'basic'
2024-04-16 17:16:55,089 - DEBUG -      Entering _get_cookie_and_crumb_basic()
2024-04-16 17:16:55,093 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_cookieschema" ("strategy" VARCHAR(255) NOT NULL PRIMARY KEY, "fetch_date" DATETIME NOT NULL, "cookie_bytes" BLOB NOT NULL) WITHOUT ROWID', [])
2024-04-16 17:16:55,093 - DEBUG - ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2024-04-16 17:16:55,094 - DEBUG - loaded persistent cookie
2024-04-16 17:16:55,094 - DEBUG - reusing cookie
2024-04-16 17:16:55,152 - DEBUG - Starting new HTTPS connection (1): query1.finance.yahoo.com:443
2024-04-16 17:16:55,208 - DEBUG - https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2024-04-16 17:16:55,209 - DEBUG - crumb = '2ylVJsw6yG2'
2024-04-16 17:16:55,209 - DEBUG -      Exiting _get_cookie_and_crumb_basic()
2024-04-16 17:16:55,209 - DEBUG -     Exiting _get_cookie_and_crumb()
2024-04-16 17:16:55,213 - DEBUG - Starting new HTTPS connection (1): query2.finance.yahoo.com:443
2024-04-16 17:16:55,325 - DEBUG - https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/AAPL?period1=1577854800&period2=1704085200&interval=1d&includePrePost=False&events=div%2Csplits%2CcapitalGains&crumb=2ylVJsw6yG2 HTTP/1.1" 200 None
2024-04-16 17:16:55,343 - DEBUG - response code=200
2024-04-16 17:16:55,344 - DEBUG -    Exiting get()
2024-04-16 17:16:55,366 - DEBUG - AAPL: yfinance received OHLC data: 2020-01-02 14:30:00 -> 2023-12-29 14:30:00
2024-04-16 17:16:55,377 - DEBUG - AAPL: OHLC after cleaning: 2020-01-02 09:30:00-05:00 -> 2023-12-29 09:30:00-05:00
2024-04-16 17:16:55,439 - DEBUG - AAPL: OHLC after combining events: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:16:55,445 - DEBUG - AAPL: yfinance returning OHLC: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:16:55,446 - DEBUG -   Exiting history()
2024-04-16 17:16:55,446 - DEBUG -  Exiting history()
2024-04-16 17:16:55,446 - DEBUG - Exiting download()
2024-04-16 17:16:55,446 - INFO - Swapping 'Adj Close' data into 'Close' column...
2024-04-16 17:16:55,447 - INFO - Removing 'Adj Close' column...
2024-04-16 17:16:55,448 - INFO - First few rows of the dataframe:
2024-04-16 17:16:55,448 - INFO -                  Open       High        Low      Close     Volume
Date                                                             
2020-01-02  74.059998  75.150002  73.797501  73.059425  135480400
2020-01-03  74.287498  75.144997  74.125000  72.349136  146322800
2020-01-06  73.447502  74.989998  73.187500  72.925636  118387200
2020-01-07  74.959999  75.224998  74.370003  72.582664  108872000
2020-01-08  74.290001  76.110001  74.290001  73.750244  132079200
2024-04-16 17:16:55,467 - INFO - Checking for missing values...
2024-04-16 17:16:55,468 - INFO - Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
2024-04-16 17:16:55,470 - INFO - Filling missing values, if any...
2024-04-16 17:16:55,472 - INFO - Calculating technical indicators...
2024-04-16 17:16:55,498 - INFO - Checking for NaN values after calculating technical indicators...
2024-04-16 17:16:55,500 - INFO - Open              0
High              0
Low               0
Close             0
Volume            0
SMA_10            9
SMA_50           49
EMA_20           19
RSI              14
STOCH_K          17
STOCH_D          17
MACD             33
MACDSIGNAL       33
MACDHIST         33
ADX              27
OBV               0
ATR              14
BBANDS_UPPER     19
BBANDS_MIDDLE    19
BBANDS_LOWER     19
MOM              10
CCI              13
WILLR            13
TSF              13
TRIX             88
ULTOSC           28
ROC              10
PLUS_DI          14
MINUS_DI         14
PLUS_DM          13
MINUS_DM         13
dtype: int64
2024-04-16 17:16:55,501 - INFO - Forward-filling NaN values...
2024-04-16 17:16:55,506 - INFO - Performing correlation analysis...
2024-04-16 17:16:55,513 - INFO - Correlation Matrix:
                  Close    Volume    SMA_10  ...  MINUS_DI   PLUS_DM  MINUS_DM
Close          1.000000 -0.556960  0.987863  ...  0.133784  0.188009 -0.003261
Volume        -0.556960  1.000000 -0.553656  ... -0.062147  0.226621  0.129785
SMA_10         0.987863 -0.553656  1.000000  ...  0.231659  0.113133  0.083568
SMA_50         0.940518 -0.564787  0.960735  ...  0.421796  0.009269  0.272974
EMA_20         0.981609 -0.557995  0.996117  ...  0.291564  0.080589  0.141583
RSI            0.030978  0.046877 -0.089781  ... -0.897301  0.480139 -0.818051
STOCH_K        0.190154 -0.093407  0.071923  ... -0.638926  0.511783 -0.578090
STOCH_D        0.194849 -0.081934  0.095800  ... -0.629684  0.491952 -0.580167
MACD           0.084122  0.076523  0.019574  ... -0.814082  0.458900 -0.778823
MACDSIGNAL     0.072951  0.108869  0.045970  ... -0.699396  0.339619 -0.683674
MACDHIST       0.050137 -0.078290 -0.072848  ... -0.504378  0.443557 -0.440066
ADX            0.083597  0.177829  0.064402  ... -0.386165  0.147314 -0.395610
OBV            0.747800 -0.318972  0.728020  ...  0.049478  0.277489 -0.003349
ATR           -0.206290  0.434362 -0.186274  ...  0.370548  0.443536  0.685009
BBANDS_UPPER   0.967553 -0.514344  0.986220  ...  0.335402  0.118290  0.203381
BBANDS_MIDDLE  0.974566 -0.551469  0.993160  ...  0.310158  0.062538  0.158342
BBANDS_LOWER   0.967618 -0.581948  0.985864  ...  0.279433  0.003766  0.109289
MOM            0.067148 -0.002646 -0.063443  ... -0.700528  0.498327 -0.632279
CCI            0.027230 -0.010088 -0.110643  ... -0.728646  0.421371 -0.654291
WILLR          0.179111 -0.098426  0.046120  ... -0.604914  0.494691 -0.538150
TSF            0.993352 -0.551086  0.989063  ...  0.124772  0.186557 -0.013585
TRIX          -0.168298  0.401657 -0.164337  ... -0.395388  0.067017 -0.342707
ULTOSC         0.513720 -0.235504  0.430679  ... -0.108213  0.496215 -0.144546
ROC           -0.027869  0.074886 -0.155270  ... -0.705479  0.480797 -0.635385
PLUS_DI        0.382258 -0.072356  0.292117  ... -0.524262  0.760843 -0.502452
MINUS_DI       0.133784 -0.062147  0.231659  ...  1.000000 -0.274478  0.917048
PLUS_DM        0.188009  0.226621  0.113133  ... -0.274478  1.000000 -0.061485
MINUS_DM      -0.003261  0.129785  0.083568  ...  0.917048 -0.061485  1.000000

[28 rows x 28 columns]
2024-04-16 17:16:55,568 - INFO - Selecting features based on correlation with the target variable...
2024-04-16 17:16:55,594 - INFO - Selected Features (Correlation): ['Volume', 'SMA_10', 'SMA_50', 'EMA_20', 'OBV', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'ULTOSC']
2024-04-16 17:16:55,594 - INFO - Performing recursive feature elimination...
2024-04-16 17:16:55,691 - INFO - Selected Features (RFE): ['SMA_10', 'SMA_50', 'MACD', 'MACDSIGNAL', 'MACDHIST', 'ATR', 'BBANDS_MIDDLE', 'TSF', 'TRIX', 'MINUS_DM']
2024-04-16 17:16:55,691 - INFO - Updating selected features based on feature selection results...
2024-04-16 17:16:55,692 - INFO - Final Selected Features: ['Close', 'ULTOSC', 'MINUS_DM', 'SMA_50', 'MACDHIST', 'TRIX', 'Volume', 'MACDSIGNAL', 'SMA_10', 'EMA_20', 'BBANDS_MIDDLE', 'TSF', 'BBANDS_UPPER', 'BBANDS_LOWER', 'OBV', 'MACD', 'ATR']
2024-04-16 17:16:55,692 - INFO - Feature Importances (SelectKBest):
2024-04-16 17:16:55,692 - INFO - Volume: 411.9298447541003
2024-04-16 17:16:55,694 - INFO - SMA_10: 37048.739482509416
2024-04-16 17:16:55,694 - INFO - SMA_50: 7019.785223374666
2024-04-16 17:16:55,694 - INFO - EMA_20: 24218.388867406615
2024-04-16 17:16:55,694 - INFO - OBV: 0.8798849220711578
2024-04-16 17:16:55,694 - INFO - BBANDS_UPPER: 34.363721939020444
2024-04-16 17:16:55,694 - INFO - BBANDS_MIDDLE: 36.149559814565755
2024-04-16 17:16:55,694 - INFO - BBANDS_LOWER: 6.528331126024763
2024-04-16 17:16:55,694 - INFO - TSF: 4.900949324627692
2024-04-16 17:16:55,694 - INFO - ULTOSC: 2.3083952792604014
2024-04-16 17:16:55,695 - INFO - Feature Importances (RFE):
2024-04-16 17:16:55,695 - INFO - SMA_10: 17
2024-04-16 17:16:55,695 - INFO - SMA_50: 1
2024-04-16 17:16:55,695 - INFO - MACD: 1
2024-04-16 17:16:55,695 - INFO - MACDSIGNAL: 2
2024-04-16 17:16:55,695 - INFO - MACDHIST: 4
2024-04-16 17:16:55,695 - INFO - ATR: 10
2024-04-16 17:16:55,695 - INFO - BBANDS_MIDDLE: 16
2024-04-16 17:16:55,695 - INFO - TSF: 1
2024-04-16 17:16:55,695 - INFO - TRIX: 1
2024-04-16 17:16:55,696 - INFO - MINUS_DM: 1
2024-04-16 17:16:55,696 - INFO - Defining the scaler...
2024-04-16 17:16:55,696 - INFO - Scaling the selected features...
2024-04-16 17:16:55,712 - INFO - Preparing the data for training...
2024-04-16 17:16:55,728 - INFO - Performing hyperparameter tuning...
2024-04-16 17:20:44,768 - INFO - Starting script execution.
2024-04-16 17:20:44,769 - INFO - TensorFlow Version: 2.16.1
2024-04-16 17:20:44,769 - INFO - Fetching stock_data data...
2024-04-16 17:20:44,769 - DEBUG - Entering download()
2024-04-16 17:20:44,769 - DEBUG - Disabling multithreading because DEBUG logging enabled
2024-04-16 17:20:44,770 - DEBUG -  Entering history()
2024-04-16 17:20:44,785 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_kv" ("key" VARCHAR(255) NOT NULL PRIMARY KEY, "value" VARCHAR(255)) WITHOUT ROWID', [])
2024-04-16 17:20:44,786 - DEBUG - ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['AAPL', 1, 0])
2024-04-16 17:20:44,843 - DEBUG -   Entering history()
2024-04-16 17:20:44,850 - DEBUG - AAPL: Yahoo GET parameters: {'period1': '2020-01-01 00:00:00-05:00', 'period2': '2024-01-01 00:00:00-05:00', 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'}
2024-04-16 17:20:44,851 - DEBUG -    Entering get()
2024-04-16 17:20:44,851 - DEBUG - url=https://query2.finance.yahoo.com/v8/finance/chart/AAPL
2024-04-16 17:20:44,851 - DEBUG - params=frozendict.frozendict({'period1': 1577854800, 'period2': 1704085200, 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'})
2024-04-16 17:20:44,851 - DEBUG -     Entering _get_cookie_and_crumb()
2024-04-16 17:20:44,851 - DEBUG - cookie_mode = 'basic'
2024-04-16 17:20:44,852 - DEBUG -      Entering _get_cookie_and_crumb_basic()
2024-04-16 17:20:44,854 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_cookieschema" ("strategy" VARCHAR(255) NOT NULL PRIMARY KEY, "fetch_date" DATETIME NOT NULL, "cookie_bytes" BLOB NOT NULL) WITHOUT ROWID', [])
2024-04-16 17:20:44,855 - DEBUG - ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2024-04-16 17:20:44,856 - DEBUG - loaded persistent cookie
2024-04-16 17:20:44,856 - DEBUG - reusing cookie
2024-04-16 17:20:44,900 - DEBUG - Starting new HTTPS connection (1): query1.finance.yahoo.com:443
2024-04-16 17:20:44,952 - DEBUG - https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2024-04-16 17:20:44,953 - DEBUG - crumb = '2ylVJsw6yG2'
2024-04-16 17:20:44,953 - DEBUG -      Exiting _get_cookie_and_crumb_basic()
2024-04-16 17:20:44,953 - DEBUG -     Exiting _get_cookie_and_crumb()
2024-04-16 17:20:44,956 - DEBUG - Starting new HTTPS connection (1): query2.finance.yahoo.com:443
2024-04-16 17:20:45,054 - DEBUG - https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/AAPL?period1=1577854800&period2=1704085200&interval=1d&includePrePost=False&events=div%2Csplits%2CcapitalGains&crumb=2ylVJsw6yG2 HTTP/1.1" 200 None
2024-04-16 17:20:45,073 - DEBUG - response code=200
2024-04-16 17:20:45,074 - DEBUG -    Exiting get()
2024-04-16 17:20:45,091 - DEBUG - AAPL: yfinance received OHLC data: 2020-01-02 14:30:00 -> 2023-12-29 14:30:00
2024-04-16 17:20:45,100 - DEBUG - AAPL: OHLC after cleaning: 2020-01-02 09:30:00-05:00 -> 2023-12-29 09:30:00-05:00
2024-04-16 17:20:45,142 - DEBUG - AAPL: OHLC after combining events: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:20:45,149 - DEBUG - AAPL: yfinance returning OHLC: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:20:45,149 - DEBUG -   Exiting history()
2024-04-16 17:20:45,149 - DEBUG -  Exiting history()
2024-04-16 17:20:45,149 - DEBUG - Exiting download()
2024-04-16 17:20:45,150 - INFO - Swapping 'Adj Close' data into 'Close' column...
2024-04-16 17:20:45,151 - INFO - Removing 'Adj Close' column...
2024-04-16 17:20:45,151 - INFO - First few rows of the dataframe:
2024-04-16 17:20:45,151 - INFO -                  Open       High        Low      Close     Volume
Date                                                             
2020-01-02  74.059998  75.150002  73.797501  73.059425  135480400
2020-01-03  74.287498  75.144997  74.125000  72.349136  146322800
2020-01-06  73.447502  74.989998  73.187500  72.925629  118387200
2020-01-07  74.959999  75.224998  74.370003  72.582672  108872000
2020-01-08  74.290001  76.110001  74.290001  73.750259  132079200
2024-04-16 17:20:45,163 - INFO - Checking for missing values...
2024-04-16 17:20:45,165 - INFO - Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
2024-04-16 17:20:45,165 - INFO - Filling missing values, if any...
2024-04-16 17:20:45,166 - INFO - Calculating technical indicators...
2024-04-16 17:20:45,181 - INFO - Checking for NaN values after calculating technical indicators...
2024-04-16 17:20:45,183 - INFO - Open              0
High              0
Low               0
Close             0
Volume            0
SMA_10            9
SMA_50           49
EMA_20           19
RSI              14
STOCH_K          17
STOCH_D          17
MACD             33
MACDSIGNAL       33
MACDHIST         33
ADX              27
OBV               0
ATR              14
BBANDS_UPPER     19
BBANDS_MIDDLE    19
BBANDS_LOWER     19
MOM              10
CCI              13
WILLR            13
TSF              13
TRIX             88
ULTOSC           28
ROC              10
PLUS_DI          14
MINUS_DI         14
PLUS_DM          13
MINUS_DM         13
dtype: int64
2024-04-16 17:20:45,184 - INFO - Forward-filling NaN values...
2024-04-16 17:20:45,186 - INFO - Performing correlation analysis...
2024-04-16 17:20:45,192 - INFO - Correlation Matrix:
                  Close    Volume    SMA_10  ...  MINUS_DI   PLUS_DM  MINUS_DM
Close          1.000000 -0.556960  0.987863  ...  0.133783  0.188009 -0.003261
Volume        -0.556960  1.000000 -0.553656  ... -0.062147  0.226621  0.129785
SMA_10         0.987863 -0.553656  1.000000  ...  0.231658  0.113133  0.083568
SMA_50         0.940518 -0.564787  0.960735  ...  0.421796  0.009269  0.272974
EMA_20         0.981609 -0.557995  0.996117  ...  0.291564  0.080589  0.141583
RSI            0.030978  0.046877 -0.089781  ... -0.897301  0.480138 -0.818051
STOCH_K        0.190154 -0.093407  0.071923  ... -0.638927  0.511783 -0.578090
STOCH_D        0.194849 -0.081934  0.095800  ... -0.629684  0.491952 -0.580167
MACD           0.084122  0.076523  0.019574  ... -0.814082  0.458900 -0.778823
MACDSIGNAL     0.072951  0.108869  0.045970  ... -0.699396  0.339619 -0.683674
MACDHIST       0.050137 -0.078290 -0.072848  ... -0.504378  0.443557 -0.440066
ADX            0.083597  0.177829  0.064402  ... -0.386165  0.147314 -0.395610
OBV            0.747800 -0.318972  0.728020  ...  0.049478  0.277489 -0.003349
ATR           -0.206289  0.434361 -0.186273  ...  0.370548  0.443537  0.685009
BBANDS_UPPER   0.967553 -0.514344  0.986220  ...  0.335402  0.118290  0.203381
BBANDS_MIDDLE  0.974566 -0.551469  0.993160  ...  0.310158  0.062538  0.158342
BBANDS_LOWER   0.967618 -0.581948  0.985864  ...  0.279432  0.003766  0.109289
MOM            0.067148 -0.002646 -0.063443  ... -0.700528  0.498328 -0.632279
CCI            0.027230 -0.010088 -0.110643  ... -0.728646  0.421371 -0.654291
WILLR          0.179111 -0.098426  0.046121  ... -0.604914  0.494691 -0.538150
TSF            0.993352 -0.551086  0.989063  ...  0.124772  0.186557 -0.013585
TRIX          -0.168298  0.401657 -0.164337  ... -0.395388  0.067017 -0.342707
ULTOSC         0.513721 -0.235504  0.430679  ... -0.108213  0.496215 -0.144546
ROC           -0.027869  0.074886 -0.155270  ... -0.705479  0.480797 -0.635385
PLUS_DI        0.382257 -0.072355  0.292117  ... -0.524263  0.760843 -0.502453
MINUS_DI       0.133783 -0.062147  0.231658  ...  1.000000 -0.274478  0.917048
PLUS_DM        0.188009  0.226621  0.113133  ... -0.274478  1.000000 -0.061485
MINUS_DM      -0.003261  0.129785  0.083568  ...  0.917048 -0.061485  1.000000

[28 rows x 28 columns]
2024-04-16 17:20:45,244 - INFO - Selecting features based on correlation with the target variable...
2024-04-16 17:20:45,266 - INFO - Selected Features (Correlation): ['Volume', 'SMA_10', 'SMA_50', 'EMA_20', 'OBV', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'ULTOSC']
2024-04-16 17:20:45,280 - INFO - Performing recursive feature elimination...
2024-04-16 17:20:45,339 - INFO - Selected Features (RFE): ['SMA_10', 'SMA_50', 'MACD', 'MACDSIGNAL', 'MACDHIST', 'ATR', 'BBANDS_MIDDLE', 'TSF', 'TRIX', 'MINUS_DM']
2024-04-16 17:20:45,339 - INFO - Updating selected features based on feature selection results...
2024-04-16 17:20:45,340 - INFO - Final Selected Features: ['MACDSIGNAL', 'Volume', 'MACD', 'TSF', 'SMA_10', 'ULTOSC', 'MACDHIST', 'SMA_50', 'BBANDS_MIDDLE', 'ATR', 'EMA_20', 'BBANDS_UPPER', 'Close', 'BBANDS_LOWER', 'TRIX', 'MINUS_DM', 'OBV']
2024-04-16 17:20:45,340 - INFO - Feature Importances (SelectKBest):
2024-04-16 17:20:45,340 - INFO - Volume: 411.92985367807836
2024-04-16 17:20:45,341 - INFO - SMA_10: 37048.74659337473
2024-04-16 17:20:45,341 - INFO - SMA_50: 7019.785390323065
2024-04-16 17:20:45,341 - INFO - EMA_20: 24218.391425490954
2024-04-16 17:20:45,341 - INFO - OBV: 0.8798545968511624
2024-04-16 17:20:45,341 - INFO - BBANDS_UPPER: 34.36373424200035
2024-04-16 17:20:45,341 - INFO - BBANDS_MIDDLE: 36.1495683625038
2024-04-16 17:20:45,341 - INFO - BBANDS_LOWER: 6.528332029326226
2024-04-16 17:20:45,341 - INFO - TSF: 4.900950552670885
2024-04-16 17:20:45,341 - INFO - ULTOSC: 2.3083945854955776
2024-04-16 17:20:45,341 - INFO - Feature Importances (RFE):
2024-04-16 17:20:45,341 - INFO - SMA_10: 17
2024-04-16 17:20:45,341 - INFO - SMA_50: 1
2024-04-16 17:20:45,342 - INFO - MACD: 1
2024-04-16 17:20:45,342 - INFO - MACDSIGNAL: 2
2024-04-16 17:20:45,342 - INFO - MACDHIST: 4
2024-04-16 17:20:45,342 - INFO - ATR: 10
2024-04-16 17:20:45,342 - INFO - BBANDS_MIDDLE: 16
2024-04-16 17:20:45,342 - INFO - TSF: 1
2024-04-16 17:20:45,342 - INFO - TRIX: 1
2024-04-16 17:20:45,342 - INFO - MINUS_DM: 1
2024-04-16 17:20:45,342 - INFO - Defining the scaler...
2024-04-16 17:20:45,342 - INFO - Scaling the selected features...
2024-04-16 17:20:45,352 - INFO - Preparing the data for training...
2024-04-16 17:20:45,365 - INFO - Performing hyperparameter tuning...
2024-04-16 17:37:29,260 - INFO - Starting script execution.
2024-04-16 17:37:29,261 - INFO - TensorFlow Version: 2.16.1
2024-04-16 17:37:29,261 - INFO - Fetching stock_data data...
2024-04-16 17:37:29,261 - DEBUG - Entering download()
2024-04-16 17:37:29,261 - DEBUG - Disabling multithreading because DEBUG logging enabled
2024-04-16 17:37:29,262 - DEBUG -  Entering history()
2024-04-16 17:37:29,275 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_kv" ("key" VARCHAR(255) NOT NULL PRIMARY KEY, "value" VARCHAR(255)) WITHOUT ROWID', [])
2024-04-16 17:37:29,276 - DEBUG - ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['AAPL', 1, 0])
2024-04-16 17:37:29,302 - DEBUG -   Entering history()
2024-04-16 17:37:29,313 - DEBUG - AAPL: Yahoo GET parameters: {'period1': '2020-01-01 00:00:00-05:00', 'period2': '2024-01-01 00:00:00-05:00', 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'}
2024-04-16 17:37:29,319 - DEBUG -    Entering get()
2024-04-16 17:37:29,320 - DEBUG - url=https://query2.finance.yahoo.com/v8/finance/chart/AAPL
2024-04-16 17:37:29,320 - DEBUG - params=frozendict.frozendict({'period1': 1577854800, 'period2': 1704085200, 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'})
2024-04-16 17:37:29,320 - DEBUG -     Entering _get_cookie_and_crumb()
2024-04-16 17:37:29,320 - DEBUG - cookie_mode = 'basic'
2024-04-16 17:37:29,320 - DEBUG -      Entering _get_cookie_and_crumb_basic()
2024-04-16 17:37:29,321 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_cookieschema" ("strategy" VARCHAR(255) NOT NULL PRIMARY KEY, "fetch_date" DATETIME NOT NULL, "cookie_bytes" BLOB NOT NULL) WITHOUT ROWID', [])
2024-04-16 17:37:29,322 - DEBUG - ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2024-04-16 17:37:29,323 - DEBUG - loaded persistent cookie
2024-04-16 17:37:29,323 - DEBUG - reusing cookie
2024-04-16 17:37:29,358 - DEBUG - Starting new HTTPS connection (1): query1.finance.yahoo.com:443
2024-04-16 17:37:29,407 - DEBUG - https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2024-04-16 17:37:29,408 - DEBUG - crumb = '2ylVJsw6yG2'
2024-04-16 17:37:29,408 - DEBUG -      Exiting _get_cookie_and_crumb_basic()
2024-04-16 17:37:29,409 - DEBUG -     Exiting _get_cookie_and_crumb()
2024-04-16 17:37:29,422 - DEBUG - Starting new HTTPS connection (1): query2.finance.yahoo.com:443
2024-04-16 17:37:29,537 - DEBUG - https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/AAPL?period1=1577854800&period2=1704085200&interval=1d&includePrePost=False&events=div%2Csplits%2CcapitalGains&crumb=2ylVJsw6yG2 HTTP/1.1" 200 None
2024-04-16 17:37:29,556 - DEBUG - response code=200
2024-04-16 17:37:29,557 - DEBUG -    Exiting get()
2024-04-16 17:37:29,589 - DEBUG - AAPL: yfinance received OHLC data: 2020-01-02 14:30:00 -> 2023-12-29 14:30:00
2024-04-16 17:37:29,602 - DEBUG - AAPL: OHLC after cleaning: 2020-01-02 09:30:00-05:00 -> 2023-12-29 09:30:00-05:00
2024-04-16 17:37:29,659 - DEBUG - AAPL: OHLC after combining events: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:37:29,665 - DEBUG - AAPL: yfinance returning OHLC: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:37:29,665 - DEBUG -   Exiting history()
2024-04-16 17:37:29,665 - DEBUG -  Exiting history()
2024-04-16 17:37:29,666 - DEBUG - Exiting download()
2024-04-16 17:37:29,666 - INFO - Swapping 'Adj Close' data into 'Close' column...
2024-04-16 17:37:29,667 - INFO - Removing 'Adj Close' column...
2024-04-16 17:37:29,667 - INFO - First few rows of the dataframe:
2024-04-16 17:37:29,667 - INFO -                  Open       High        Low      Close     Volume
Date                                                             
2020-01-02  74.059998  75.150002  73.797501  73.059418  135480400
2020-01-03  74.287498  75.144997  74.125000  72.349144  146322800
2020-01-06  73.447502  74.989998  73.187500  72.925636  118387200
2020-01-07  74.959999  75.224998  74.370003  72.582680  108872000
2020-01-08  74.290001  76.110001  74.290001  73.750244  132079200
2024-04-16 17:37:29,680 - INFO - Checking for missing values...
2024-04-16 17:37:29,682 - INFO - Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
2024-04-16 17:37:29,682 - INFO - Filling missing values, if any...
2024-04-16 17:37:29,683 - INFO - Calculating technical indicators...
2024-04-16 17:37:29,705 - INFO - Checking for NaN values after calculating technical indicators...
2024-04-16 17:37:29,707 - INFO - Open              0
High              0
Low               0
Close             0
Volume            0
SMA_10            9
SMA_50           49
EMA_20           19
RSI              14
STOCH_K          17
STOCH_D          17
MACD             33
MACDSIGNAL       33
MACDHIST         33
ADX              27
OBV               0
ATR              14
BBANDS_UPPER     19
BBANDS_MIDDLE    19
BBANDS_LOWER     19
MOM              10
CCI              13
WILLR            13
TSF              13
TRIX             88
ULTOSC           28
ROC              10
PLUS_DI          14
MINUS_DI         14
PLUS_DM          13
MINUS_DM         13
dtype: int64
2024-04-16 17:37:29,708 - INFO - Forward-filling NaN values...
2024-04-16 17:37:29,710 - INFO - Performing correlation analysis...
2024-04-16 17:37:29,718 - INFO - Correlation Matrix:
                  Close    Volume    SMA_10  ...  MINUS_DI   PLUS_DM  MINUS_DM
Close          1.000000 -0.556960  0.987863  ...  0.133784  0.188009 -0.003261
Volume        -0.556960  1.000000 -0.553656  ... -0.062147  0.226621  0.129785
SMA_10         0.987863 -0.553656  1.000000  ...  0.231659  0.113133  0.083568
SMA_50         0.940518 -0.564787  0.960735  ...  0.421796  0.009269  0.272974
EMA_20         0.981609 -0.557995  0.996117  ...  0.291564  0.080589  0.141583
RSI            0.030978  0.046877 -0.089781  ... -0.897301  0.480138 -0.818051
STOCH_K        0.190154 -0.093407  0.071923  ... -0.638927  0.511783 -0.578090
STOCH_D        0.194849 -0.081934  0.095800  ... -0.629684  0.491952 -0.580167
MACD           0.084122  0.076523  0.019574  ... -0.814082  0.458900 -0.778823
MACDSIGNAL     0.072951  0.108869  0.045970  ... -0.699396  0.339619 -0.683674
MACDHIST       0.050137 -0.078290 -0.072848  ... -0.504378  0.443557 -0.440066
ADX            0.083597  0.177829  0.064402  ... -0.386165  0.147314 -0.395610
OBV            0.747800 -0.318972  0.728020  ...  0.049478  0.277489 -0.003349
ATR           -0.206290  0.434362 -0.186274  ...  0.370548  0.443536  0.685009
BBANDS_UPPER   0.967553 -0.514344  0.986220  ...  0.335402  0.118290  0.203381
BBANDS_MIDDLE  0.974566 -0.551469  0.993160  ...  0.310158  0.062538  0.158342
BBANDS_LOWER   0.967618 -0.581948  0.985864  ...  0.279433  0.003765  0.109289
MOM            0.067148 -0.002646 -0.063443  ... -0.700528  0.498327 -0.632279
CCI            0.027230 -0.010088 -0.110643  ... -0.728646  0.421371 -0.654291
WILLR          0.179111 -0.098426  0.046121  ... -0.604914  0.494691 -0.538150
TSF            0.993352 -0.551086  0.989063  ...  0.124772  0.186557 -0.013585
TRIX          -0.168298  0.401657 -0.164337  ... -0.395388  0.067017 -0.342707
ULTOSC         0.513720 -0.235504  0.430679  ... -0.108214  0.496215 -0.144546
ROC           -0.027869  0.074886 -0.155270  ... -0.705479  0.480797 -0.635385
PLUS_DI        0.382258 -0.072356  0.292117  ... -0.524263  0.760843 -0.502453
MINUS_DI       0.133784 -0.062147  0.231659  ...  1.000000 -0.274478  0.917048
PLUS_DM        0.188009  0.226621  0.113133  ... -0.274478  1.000000 -0.061485
MINUS_DM      -0.003261  0.129785  0.083568  ...  0.917048 -0.061485  1.000000

[28 rows x 28 columns]
2024-04-16 17:37:29,758 - INFO - Selecting features based on correlation with the target variable...
2024-04-16 17:37:29,778 - INFO - Selected Features (Correlation): ['Volume', 'SMA_10', 'SMA_50', 'EMA_20', 'OBV', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'ULTOSC']
2024-04-16 17:37:29,779 - INFO - Performing recursive feature elimination...
2024-04-16 17:37:29,827 - INFO - Selected Features (RFE): ['SMA_10', 'SMA_50', 'MACD', 'MACDSIGNAL', 'MACDHIST', 'ATR', 'BBANDS_MIDDLE', 'TSF', 'TRIX', 'MINUS_DM']
2024-04-16 17:37:29,827 - INFO - Updating selected features based on feature selection results...
2024-04-16 17:37:29,827 - INFO - Final Selected Features: ['OBV', 'SMA_50', 'BBANDS_UPPER', 'MACDSIGNAL', 'BBANDS_MIDDLE', 'MACD', 'MINUS_DM', 'TRIX', 'Close', 'EMA_20', 'Volume', 'MACDHIST', 'TSF', 'SMA_10', 'ULTOSC', 'BBANDS_LOWER', 'ATR']
2024-04-16 17:37:29,827 - INFO - Feature Importances (SelectKBest):
2024-04-16 17:37:29,827 - INFO - Volume: 411.9298997519843
2024-04-16 17:37:29,828 - INFO - SMA_10: 37048.73563346782
2024-04-16 17:37:29,828 - INFO - SMA_50: 7019.784625008106
2024-04-16 17:37:29,828 - INFO - EMA_20: 24218.386119231178
2024-04-16 17:37:29,828 - INFO - OBV: 0.8798484126087665
2024-04-16 17:37:29,828 - INFO - BBANDS_UPPER: 34.363763124186825
2024-04-16 17:37:29,828 - INFO - BBANDS_MIDDLE: 36.1496059670651
2024-04-16 17:37:29,828 - INFO - BBANDS_LOWER: 6.528338598213483
2024-04-16 17:37:29,828 - INFO - TSF: 4.9009547227689945
2024-04-16 17:37:29,828 - INFO - ULTOSC: 2.30839819326833
2024-04-16 17:37:29,828 - INFO - Feature Importances (RFE):
2024-04-16 17:37:29,828 - INFO - SMA_10: 17
2024-04-16 17:37:29,828 - INFO - SMA_50: 1
2024-04-16 17:37:29,828 - INFO - MACD: 1
2024-04-16 17:37:29,828 - INFO - MACDSIGNAL: 2
2024-04-16 17:37:29,828 - INFO - MACDHIST: 4
2024-04-16 17:37:29,828 - INFO - ATR: 10
2024-04-16 17:37:29,828 - INFO - BBANDS_MIDDLE: 16
2024-04-16 17:37:29,829 - INFO - TSF: 1
2024-04-16 17:37:29,829 - INFO - TRIX: 1
2024-04-16 17:37:29,829 - INFO - MINUS_DM: 1
2024-04-16 17:37:29,829 - INFO - Defining the scaler...
2024-04-16 17:37:29,829 - INFO - Scaling the selected features...
2024-04-16 17:37:29,833 - INFO - Preparing the data for training...
2024-04-16 17:37:29,837 - INFO - Performing hyperparameter tuning...
2024-04-16 17:38:44,506 - INFO - Starting script execution.
2024-04-16 17:38:44,506 - INFO - TensorFlow Version: 2.16.1
2024-04-16 17:38:44,507 - INFO - Fetching stock_data data...
2024-04-16 17:38:44,507 - DEBUG - Entering download()
2024-04-16 17:38:44,507 - DEBUG - Disabling multithreading because DEBUG logging enabled
2024-04-16 17:38:44,508 - DEBUG -  Entering history()
2024-04-16 17:38:44,531 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_kv" ("key" VARCHAR(255) NOT NULL PRIMARY KEY, "value" VARCHAR(255)) WITHOUT ROWID', [])
2024-04-16 17:38:44,532 - DEBUG - ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['AAPL', 1, 0])
2024-04-16 17:38:44,573 - DEBUG -   Entering history()
2024-04-16 17:38:44,586 - DEBUG - AAPL: Yahoo GET parameters: {'period1': '2020-01-01 00:00:00-05:00', 'period2': '2024-01-01 00:00:00-05:00', 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'}
2024-04-16 17:38:44,591 - DEBUG -    Entering get()
2024-04-16 17:38:44,592 - DEBUG - url=https://query2.finance.yahoo.com/v8/finance/chart/AAPL
2024-04-16 17:38:44,592 - DEBUG - params=frozendict.frozendict({'period1': 1577854800, 'period2': 1704085200, 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'})
2024-04-16 17:38:44,592 - DEBUG -     Entering _get_cookie_and_crumb()
2024-04-16 17:38:44,592 - DEBUG - cookie_mode = 'basic'
2024-04-16 17:38:44,592 - DEBUG -      Entering _get_cookie_and_crumb_basic()
2024-04-16 17:38:44,594 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_cookieschema" ("strategy" VARCHAR(255) NOT NULL PRIMARY KEY, "fetch_date" DATETIME NOT NULL, "cookie_bytes" BLOB NOT NULL) WITHOUT ROWID', [])
2024-04-16 17:38:44,595 - DEBUG - ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2024-04-16 17:38:44,596 - DEBUG - loaded persistent cookie
2024-04-16 17:38:44,596 - DEBUG - reusing cookie
2024-04-16 17:38:44,644 - DEBUG - Starting new HTTPS connection (1): query1.finance.yahoo.com:443
2024-04-16 17:38:44,697 - DEBUG - https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2024-04-16 17:38:44,698 - DEBUG - crumb = '2ylVJsw6yG2'
2024-04-16 17:38:44,698 - DEBUG -      Exiting _get_cookie_and_crumb_basic()
2024-04-16 17:38:44,698 - DEBUG -     Exiting _get_cookie_and_crumb()
2024-04-16 17:38:44,703 - DEBUG - Starting new HTTPS connection (1): query2.finance.yahoo.com:443
2024-04-16 17:38:44,791 - DEBUG - https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/AAPL?period1=1577854800&period2=1704085200&interval=1d&includePrePost=False&events=div%2Csplits%2CcapitalGains&crumb=2ylVJsw6yG2 HTTP/1.1" 200 None
2024-04-16 17:38:44,809 - DEBUG - response code=200
2024-04-16 17:38:44,809 - DEBUG -    Exiting get()
2024-04-16 17:38:44,843 - DEBUG - AAPL: yfinance received OHLC data: 2020-01-02 14:30:00 -> 2023-12-29 14:30:00
2024-04-16 17:38:44,853 - DEBUG - AAPL: OHLC after cleaning: 2020-01-02 09:30:00-05:00 -> 2023-12-29 09:30:00-05:00
2024-04-16 17:38:44,903 - DEBUG - AAPL: OHLC after combining events: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:38:44,906 - DEBUG - AAPL: yfinance returning OHLC: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:38:44,907 - DEBUG -   Exiting history()
2024-04-16 17:38:44,907 - DEBUG -  Exiting history()
2024-04-16 17:38:44,907 - DEBUG - Exiting download()
2024-04-16 17:38:44,907 - INFO - Swapping 'Adj Close' data into 'Close' column...
2024-04-16 17:38:44,908 - INFO - Removing 'Adj Close' column...
2024-04-16 17:38:44,909 - INFO - First few rows of the dataframe:
2024-04-16 17:38:44,909 - INFO -                  Open       High        Low      Close     Volume
Date                                                             
2020-01-02  74.059998  75.150002  73.797501  73.059433  135480400
2020-01-03  74.287498  75.144997  74.125000  72.349136  146322800
2020-01-06  73.447502  74.989998  73.187500  72.925629  118387200
2020-01-07  74.959999  75.224998  74.370003  72.582657  108872000
2020-01-08  74.290001  76.110001  74.290001  73.750237  132079200
2024-04-16 17:38:44,919 - INFO - Checking for missing values...
2024-04-16 17:38:44,920 - INFO - Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
2024-04-16 17:38:44,920 - INFO - Filling missing values, if any...
2024-04-16 17:38:44,920 - INFO - Calculating technical indicators...
2024-04-16 17:38:44,934 - INFO - Checking for NaN values after calculating technical indicators...
2024-04-16 17:38:44,935 - INFO - Open              0
High              0
Low               0
Close             0
Volume            0
SMA_10            9
SMA_50           49
EMA_20           19
RSI              14
STOCH_K          17
STOCH_D          17
MACD             33
MACDSIGNAL       33
MACDHIST         33
ADX              27
OBV               0
ATR              14
BBANDS_UPPER     19
BBANDS_MIDDLE    19
BBANDS_LOWER     19
MOM              10
CCI              13
WILLR            13
TSF              13
TRIX             88
ULTOSC           28
ROC              10
PLUS_DI          14
MINUS_DI         14
PLUS_DM          13
MINUS_DM         13
dtype: int64
2024-04-16 17:38:44,935 - INFO - Forward-filling NaN values...
2024-04-16 17:38:44,937 - INFO - Performing correlation analysis...
2024-04-16 17:38:44,941 - INFO - Correlation Matrix:
                  Close    Volume    SMA_10    SMA_50    EMA_20  ...       ROC   PLUS_DI  MINUS_DI   PLUS_DM  MINUS_DM
Close          1.000000 -0.556960  0.987863  0.940518  0.981609  ... -0.027869  0.382257  0.133783  0.188009 -0.003261
Volume        -0.556960  1.000000 -0.553656 -0.564787 -0.557995  ...  0.074886 -0.072355 -0.062147  0.226621  0.129785
SMA_10         0.987863 -0.553656  1.000000  0.960735  0.996117  ... -0.155270  0.292117  0.231658  0.113133  0.083568
SMA_50         0.940518 -0.564787  0.960735  1.000000  0.979613  ... -0.258417  0.121069  0.421796  0.009269  0.272974
EMA_20         0.981609 -0.557995  0.996117  0.979613  1.000000  ... -0.195204  0.241311  0.291564  0.080589  0.141583
RSI            0.030977  0.046878 -0.089781 -0.278497 -0.150261  ...  0.810861  0.736249 -0.897301  0.480138 -0.818051
STOCH_K        0.190154 -0.093407  0.071923 -0.036161  0.031390  ...  0.815903  0.713681 -0.638926  0.511783 -0.578090
STOCH_D        0.194849 -0.081934  0.095800 -0.034024  0.046450  ...  0.779372  0.708322 -0.629684  0.491952 -0.580167
MACD           0.084122  0.076523  0.019574 -0.245801 -0.062628  ...  0.598339  0.687358 -0.814082  0.458900 -0.778823
MACDSIGNAL     0.072951  0.108869  0.045970 -0.231208 -0.034415  ...  0.352576  0.562915 -0.699396  0.339619 -0.683674
MACDHIST       0.050137 -0.078290 -0.072848 -0.093895 -0.095318  ...  0.841353  0.506340 -0.504378  0.443557 -0.440066
ADX            0.083597  0.177829  0.064402 -0.075905  0.029548  ...  0.194501  0.360338 -0.386165  0.147314 -0.395610
OBV            0.747800 -0.318972  0.728020  0.665749  0.715246  ...  0.029925  0.298252  0.049478  0.277489 -0.003349
ATR           -0.206289  0.434361 -0.186273 -0.095743 -0.161115  ... -0.167338 -0.216498  0.370548  0.443536  0.685009
BBANDS_UPPER   0.967553 -0.514344  0.986220  0.974039  0.992123  ... -0.226627  0.233804  0.335402  0.118290  0.203381
BBANDS_MIDDLE  0.974566 -0.551469  0.993160  0.978086  0.998661  ... -0.229919  0.219648  0.310158  0.062538  0.158342
BBANDS_LOWER   0.967618 -0.581948  0.985864  0.968008  0.990868  ... -0.229980  0.201751  0.279432  0.003766  0.109289
MOM            0.067148 -0.002646 -0.063443 -0.169503 -0.103741  ...  0.977968  0.626802 -0.700528  0.498327 -0.632279
CCI            0.027230 -0.010088 -0.110643 -0.193513 -0.139451  ...  0.808442  0.603727 -0.728646  0.421371 -0.654291
WILLR          0.179111 -0.098426  0.046120 -0.036494  0.015400  ...  0.812659  0.673042 -0.604914  0.494691 -0.538150
TSF            0.993352 -0.551086  0.989063  0.929854  0.977454  ... -0.021692  0.386444  0.124772  0.186557 -0.013585
TRIX          -0.168297  0.401657 -0.164337 -0.332417 -0.202082  ...  0.057082  0.120963 -0.395388  0.067017 -0.342707
ULTOSC         0.513720 -0.235504  0.430679  0.408517  0.423125  ...  0.421388  0.691174 -0.108214  0.496215 -0.144546
ROC           -0.027869  0.074886 -0.155270 -0.258417 -0.195204  ...  1.000000  0.595362 -0.705479  0.480797 -0.635385
PLUS_DI        0.382257 -0.072355  0.292117  0.121069  0.241311  ...  0.595362  1.000000 -0.524262  0.760843 -0.502452
MINUS_DI       0.133783 -0.062147  0.231658  0.421796  0.291564  ... -0.705479 -0.524262  1.000000 -0.274478  0.917048
PLUS_DM        0.188009  0.226621  0.113133  0.009269  0.080589  ...  0.480797  0.760843 -0.274478  1.000000 -0.061485
MINUS_DM      -0.003261  0.129785  0.083568  0.272974  0.141583  ... -0.635385 -0.502452  0.917048 -0.061485  1.000000

[28 rows x 28 columns]
2024-04-16 17:38:44,963 - INFO - Selecting features based on correlation with the target variable...
2024-04-16 17:38:44,979 - INFO - Selected Features (Correlation): ['Volume', 'SMA_10', 'SMA_50', 'EMA_20', 'OBV', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'ULTOSC']
2024-04-16 17:38:44,979 - INFO - Performing recursive feature elimination...
2024-04-16 17:38:45,012 - INFO - Selected Features (RFE): ['SMA_10', 'SMA_50', 'MACD', 'MACDSIGNAL', 'MACDHIST', 'ATR', 'BBANDS_MIDDLE', 'TSF', 'TRIX', 'MINUS_DM']
2024-04-16 17:38:45,012 - INFO - Updating selected features based on feature selection results...
2024-04-16 17:38:45,013 - INFO - Final Selected Features: ['OBV', 'ULTOSC', 'MACDHIST', 'BBANDS_MIDDLE', 'MINUS_DM', 'Close', 'MACDSIGNAL', 'MACD', 'SMA_10', 'Volume', 'BBANDS_UPPER', 'BBANDS_LOWER', 'TRIX', 'TSF', 'EMA_20', 'ATR', 'SMA_50']
2024-04-16 17:38:45,013 - INFO - Feature Importances (SelectKBest):
2024-04-16 17:38:45,013 - INFO - Volume: 411.9298650383455
2024-04-16 17:38:45,013 - INFO - SMA_10: 37048.74011456842
2024-04-16 17:38:45,014 - INFO - SMA_50: 7019.784459684863
2024-04-16 17:38:45,014 - INFO - EMA_20: 24218.387454881708
2024-04-16 17:38:45,014 - INFO - OBV: 0.879841543045487
2024-04-16 17:38:45,014 - INFO - BBANDS_UPPER: 34.36372038207667
2024-04-16 17:38:45,014 - INFO - BBANDS_MIDDLE: 36.14956031783113
2024-04-16 17:38:45,014 - INFO - BBANDS_LOWER: 6.528335940049412
2024-04-16 17:38:45,014 - INFO - TSF: 4.900954293934904
2024-04-16 17:38:45,014 - INFO - ULTOSC: 2.30839429527943
2024-04-16 17:38:45,014 - INFO - Feature Importances (RFE):
2024-04-16 17:38:45,014 - INFO - SMA_10: 17
2024-04-16 17:38:45,014 - INFO - SMA_50: 1
2024-04-16 17:38:45,014 - INFO - MACD: 1
2024-04-16 17:38:45,014 - INFO - MACDSIGNAL: 2
2024-04-16 17:38:45,014 - INFO - MACDHIST: 4
2024-04-16 17:38:45,014 - INFO - ATR: 10
2024-04-16 17:38:45,014 - INFO - BBANDS_MIDDLE: 16
2024-04-16 17:38:45,014 - INFO - TSF: 1
2024-04-16 17:38:45,015 - INFO - TRIX: 1
2024-04-16 17:38:45,015 - INFO - MINUS_DM: 1
2024-04-16 17:38:45,015 - INFO - Defining the scaler...
2024-04-16 17:38:45,015 - INFO - Scaling the selected features...
2024-04-16 17:38:45,021 - INFO - Preparing the data for training...
2024-04-16 17:42:11,286 - INFO - Starting script execution.
2024-04-16 17:42:11,287 - INFO - TensorFlow Version: 2.16.1
2024-04-16 17:42:11,288 - INFO - Fetching stock_data data...
2024-04-16 17:42:11,288 - DEBUG - Entering download()
2024-04-16 17:42:11,288 - DEBUG - Disabling multithreading because DEBUG logging enabled
2024-04-16 17:42:11,289 - DEBUG -  Entering history()
2024-04-16 17:42:11,311 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_kv" ("key" VARCHAR(255) NOT NULL PRIMARY KEY, "value" VARCHAR(255)) WITHOUT ROWID', [])
2024-04-16 17:42:11,312 - DEBUG - ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['AAPL', 1, 0])
2024-04-16 17:42:11,356 - DEBUG -   Entering history()
2024-04-16 17:42:11,366 - DEBUG - AAPL: Yahoo GET parameters: {'period1': '2020-01-01 00:00:00-05:00', 'period2': '2024-01-01 00:00:00-05:00', 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'}
2024-04-16 17:42:11,371 - DEBUG -    Entering get()
2024-04-16 17:42:11,371 - DEBUG - url=https://query2.finance.yahoo.com/v8/finance/chart/AAPL
2024-04-16 17:42:11,371 - DEBUG - params=frozendict.frozendict({'period1': 1577854800, 'period2': 1704085200, 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'})
2024-04-16 17:42:11,371 - DEBUG -     Entering _get_cookie_and_crumb()
2024-04-16 17:42:11,371 - DEBUG - cookie_mode = 'basic'
2024-04-16 17:42:11,371 - DEBUG -      Entering _get_cookie_and_crumb_basic()
2024-04-16 17:42:11,374 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_cookieschema" ("strategy" VARCHAR(255) NOT NULL PRIMARY KEY, "fetch_date" DATETIME NOT NULL, "cookie_bytes" BLOB NOT NULL) WITHOUT ROWID', [])
2024-04-16 17:42:11,375 - DEBUG - ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2024-04-16 17:42:11,376 - DEBUG - loaded persistent cookie
2024-04-16 17:42:11,376 - DEBUG - reusing cookie
2024-04-16 17:42:11,429 - DEBUG - Starting new HTTPS connection (1): query1.finance.yahoo.com:443
2024-04-16 17:42:11,485 - DEBUG - https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2024-04-16 17:42:11,486 - DEBUG - crumb = '2ylVJsw6yG2'
2024-04-16 17:42:11,486 - DEBUG -      Exiting _get_cookie_and_crumb_basic()
2024-04-16 17:42:11,486 - DEBUG -     Exiting _get_cookie_and_crumb()
2024-04-16 17:42:11,491 - DEBUG - Starting new HTTPS connection (1): query2.finance.yahoo.com:443
2024-04-16 17:42:11,592 - DEBUG - https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/AAPL?period1=1577854800&period2=1704085200&interval=1d&includePrePost=False&events=div%2Csplits%2CcapitalGains&crumb=2ylVJsw6yG2 HTTP/1.1" 200 None
2024-04-16 17:42:11,612 - DEBUG - response code=200
2024-04-16 17:42:11,612 - DEBUG -    Exiting get()
2024-04-16 17:42:11,637 - DEBUG - AAPL: yfinance received OHLC data: 2020-01-02 14:30:00 -> 2023-12-29 14:30:00
2024-04-16 17:42:11,652 - DEBUG - AAPL: OHLC after cleaning: 2020-01-02 09:30:00-05:00 -> 2023-12-29 09:30:00-05:00
2024-04-16 17:42:11,703 - DEBUG - AAPL: OHLC after combining events: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:42:11,708 - DEBUG - AAPL: yfinance returning OHLC: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:42:11,708 - DEBUG -   Exiting history()
2024-04-16 17:42:11,709 - DEBUG -  Exiting history()
2024-04-16 17:42:11,709 - DEBUG - Exiting download()
2024-04-16 17:42:11,709 - INFO - Swapping 'Adj Close' data into 'Close' column...
2024-04-16 17:42:11,710 - INFO - Removing 'Adj Close' column...
2024-04-16 17:42:11,711 - INFO - First few rows of the dataframe:
2024-04-16 17:42:11,711 - INFO -                  Open       High        Low      Close     Volume
Date                                                             
2020-01-02  74.059998  75.150002  73.797501  73.059425  135480400
2020-01-03  74.287498  75.144997  74.125000  72.349136  146322800
2020-01-06  73.447502  74.989998  73.187500  72.925629  118387200
2020-01-07  74.959999  75.224998  74.370003  72.582680  108872000
2020-01-08  74.290001  76.110001  74.290001  73.750244  132079200
2024-04-16 17:42:11,722 - INFO - Checking for missing values...
2024-04-16 17:42:11,724 - INFO - Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
2024-04-16 17:42:11,724 - INFO - Filling missing values, if any...
2024-04-16 17:42:11,725 - INFO - Calculating technical indicators...
2024-04-16 17:42:11,748 - INFO - Checking for NaN values after calculating technical indicators...
2024-04-16 17:42:11,750 - INFO - Open              0
High              0
Low               0
Close             0
Volume            0
SMA_10            9
SMA_50           49
EMA_20           19
RSI              14
STOCH_K          17
STOCH_D          17
MACD             33
MACDSIGNAL       33
MACDHIST         33
ADX              27
OBV               0
ATR              14
BBANDS_UPPER     19
BBANDS_MIDDLE    19
BBANDS_LOWER     19
MOM              10
CCI              13
WILLR            13
TSF              13
TRIX             88
ULTOSC           28
ROC              10
PLUS_DI          14
MINUS_DI         14
PLUS_DM          13
MINUS_DM         13
dtype: int64
2024-04-16 17:42:11,750 - INFO - Forward-filling NaN values...
2024-04-16 17:42:11,752 - INFO - Performing correlation analysis...
2024-04-16 17:42:11,758 - INFO - Correlation Matrix:
                  Close    Volume    SMA_10    SMA_50    EMA_20  ...       ROC   PLUS_DI  MINUS_DI   PLUS_DM  MINUS_DM
Close          1.000000 -0.556960  0.987863  0.940518  0.981609  ... -0.027869  0.382257  0.133783  0.188009 -0.003261
Volume        -0.556960  1.000000 -0.553656 -0.564787 -0.557995  ...  0.074886 -0.072355 -0.062147  0.226621  0.129785
SMA_10         0.987863 -0.553656  1.000000  0.960735  0.996117  ... -0.155270  0.292117  0.231659  0.113133  0.083568
SMA_50         0.940518 -0.564787  0.960735  1.000000  0.979613  ... -0.258417  0.121069  0.421796  0.009269  0.272974
EMA_20         0.981609 -0.557995  0.996117  0.979613  1.000000  ... -0.195204  0.241311  0.291564  0.080589  0.141583
RSI            0.030978  0.046877 -0.089781 -0.278496 -0.150260  ...  0.810861  0.736250 -0.897301  0.480139 -0.818051
STOCH_K        0.190154 -0.093407  0.071923 -0.036161  0.031390  ...  0.815903  0.713681 -0.638927  0.511783 -0.578090
STOCH_D        0.194849 -0.081934  0.095800 -0.034024  0.046450  ...  0.779372  0.708322 -0.629684  0.491952 -0.580167
MACD           0.084122  0.076523  0.019574 -0.245801 -0.062628  ...  0.598339  0.687358 -0.814082  0.458900 -0.778823
MACDSIGNAL     0.072951  0.108869  0.045970 -0.231208 -0.034415  ...  0.352576  0.562915 -0.699396  0.339619 -0.683674
MACDHIST       0.050137 -0.078290 -0.072848 -0.093895 -0.095318  ...  0.841353  0.506340 -0.504378  0.443557 -0.440066
ADX            0.083597  0.177829  0.064402 -0.075905  0.029548  ...  0.194501  0.360338 -0.386165  0.147314 -0.395610
OBV            0.747800 -0.318972  0.728020  0.665749  0.715246  ...  0.029926  0.298252  0.049478  0.277489 -0.003349
ATR           -0.206289  0.434361 -0.186273 -0.095743 -0.161115  ... -0.167338 -0.216498  0.370549  0.443536  0.685009
BBANDS_UPPER   0.967553 -0.514344  0.986220  0.974039  0.992123  ... -0.226627  0.233804  0.335402  0.118290  0.203381
BBANDS_MIDDLE  0.974566 -0.551469  0.993160  0.978086  0.998661  ... -0.229919  0.219648  0.310158  0.062538  0.158342
BBANDS_LOWER   0.967618 -0.581948  0.985864  0.968008  0.990868  ... -0.229980  0.201751  0.279432  0.003766  0.109289
MOM            0.067148 -0.002646 -0.063443 -0.169503 -0.103741  ...  0.977968  0.626802 -0.700528  0.498327 -0.632279
CCI            0.027230 -0.010088 -0.110643 -0.193513 -0.139451  ...  0.808442  0.603727 -0.728646  0.421371 -0.654291
WILLR          0.179111 -0.098426  0.046120 -0.036494  0.015400  ...  0.812659  0.673042 -0.604914  0.494691 -0.538150
TSF            0.993352 -0.551086  0.989063  0.929854  0.977454  ... -0.021692  0.386444  0.124772  0.186557 -0.013585
TRIX          -0.168297  0.401657 -0.164337 -0.332417 -0.202082  ...  0.057082  0.120964 -0.395387  0.067017 -0.342707
ULTOSC         0.513720 -0.235504  0.430679  0.408516  0.423124  ...  0.421388  0.691174 -0.108214  0.496215 -0.144546
ROC           -0.027869  0.074886 -0.155270 -0.258417 -0.195204  ...  1.000000  0.595362 -0.705479  0.480797 -0.635385
PLUS_DI        0.382257 -0.072355  0.292117  0.121069  0.241311  ...  0.595362  1.000000 -0.524263  0.760843 -0.502452
MINUS_DI       0.133783 -0.062147  0.231659  0.421796  0.291564  ... -0.705479 -0.524263  1.000000 -0.274478  0.917048
PLUS_DM        0.188009  0.226621  0.113133  0.009269  0.080589  ...  0.480797  0.760843 -0.274478  1.000000 -0.061485
MINUS_DM      -0.003261  0.129785  0.083568  0.272974  0.141583  ... -0.635385 -0.502452  0.917048 -0.061485  1.000000

[28 rows x 28 columns]
2024-04-16 17:42:11,797 - INFO - Selecting features based on correlation with the target variable...
2024-04-16 17:42:11,815 - INFO - Selected Features (Correlation): ['Volume', 'SMA_10', 'SMA_50', 'EMA_20', 'OBV', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'ULTOSC']
2024-04-16 17:42:11,816 - INFO - Performing recursive feature elimination...
2024-04-16 17:42:11,866 - INFO - Selected Features (RFE): ['SMA_10', 'SMA_50', 'MACD', 'MACDSIGNAL', 'MACDHIST', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'TRIX']
2024-04-16 17:42:11,866 - INFO - Updating selected features based on feature selection results...
2024-04-16 17:42:11,866 - INFO - Final Selected Features: ['OBV', 'Close', 'SMA_10', 'MACDHIST', 'EMA_20', 'BBANDS_MIDDLE', 'SMA_50', 'BBANDS_UPPER', 'MACD', 'TSF', 'TRIX', 'BBANDS_LOWER', 'Volume', 'MACDSIGNAL', 'ULTOSC']
2024-04-16 17:42:11,867 - INFO - Feature Importances (SelectKBest):
2024-04-16 17:42:11,867 - INFO - Volume: 411.92986836567314
2024-04-16 17:42:11,867 - INFO - SMA_10: 37048.74147095411
2024-04-16 17:42:11,867 - INFO - SMA_50: 7019.785016948249
2024-04-16 17:42:11,867 - INFO - EMA_20: 24218.389349748017
2024-04-16 17:42:11,867 - INFO - OBV: 0.879875570026703
2024-04-16 17:42:11,867 - INFO - BBANDS_UPPER: 34.363722509486934
2024-04-16 17:42:11,867 - INFO - BBANDS_MIDDLE: 36.14955893772323
2024-04-16 17:42:11,867 - INFO - BBANDS_LOWER: 6.528335732887947
2024-04-16 17:42:11,867 - INFO - TSF: 4.900953445623562
2024-04-16 17:42:11,867 - INFO - ULTOSC: 2.3083955668994736
2024-04-16 17:42:11,868 - INFO - Feature Importances (RFE):
2024-04-16 17:42:11,868 - INFO - SMA_10: 17
2024-04-16 17:42:11,868 - INFO - SMA_50: 1
2024-04-16 17:42:11,868 - INFO - MACD: 1
2024-04-16 17:42:11,868 - INFO - MACDSIGNAL: 4
2024-04-16 17:42:11,868 - INFO - MACDHIST: 6
2024-04-16 17:42:11,868 - INFO - BBANDS_UPPER: 10
2024-04-16 17:42:11,868 - INFO - BBANDS_MIDDLE: 16
2024-04-16 17:42:11,868 - INFO - BBANDS_LOWER: 1
2024-04-16 17:42:11,868 - INFO - TSF: 1
2024-04-16 17:42:11,868 - INFO - TRIX: 1
2024-04-16 17:42:11,868 - INFO - Defining the scaler...
2024-04-16 17:42:11,868 - INFO - Scaling the selected features...
2024-04-16 17:42:11,873 - INFO - Preparing the data for training...
2024-04-16 17:42:48,424 - INFO - Starting script execution.
2024-04-16 17:42:48,425 - INFO - TensorFlow Version: 2.16.1
2024-04-16 17:42:48,425 - INFO - Fetching stock_data data...
2024-04-16 17:42:48,425 - DEBUG - Entering download()
2024-04-16 17:42:48,425 - DEBUG - Disabling multithreading because DEBUG logging enabled
2024-04-16 17:42:48,425 - DEBUG -  Entering history()
2024-04-16 17:42:48,427 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_kv" ("key" VARCHAR(255) NOT NULL PRIMARY KEY, "value" VARCHAR(255)) WITHOUT ROWID', [])
2024-04-16 17:42:48,427 - DEBUG - ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['AAPL', 1, 0])
2024-04-16 17:42:48,452 - DEBUG -   Entering history()
2024-04-16 17:42:48,454 - DEBUG - AAPL: Yahoo GET parameters: {'period1': '2020-01-01 00:00:00-05:00', 'period2': '2024-01-01 00:00:00-05:00', 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'}
2024-04-16 17:42:48,454 - DEBUG -    Entering get()
2024-04-16 17:42:48,454 - DEBUG - url=https://query2.finance.yahoo.com/v8/finance/chart/AAPL
2024-04-16 17:42:48,455 - DEBUG - params=frozendict.frozendict({'period1': 1577854800, 'period2': 1704085200, 'interval': '1d', 'includePrePost': False, 'events': 'div,splits,capitalGains'})
2024-04-16 17:42:48,455 - DEBUG -     Entering _get_cookie_and_crumb()
2024-04-16 17:42:48,455 - DEBUG - cookie_mode = 'basic'
2024-04-16 17:42:48,455 - DEBUG -      Entering _get_cookie_and_crumb_basic()
2024-04-16 17:42:48,456 - DEBUG - ('CREATE TABLE IF NOT EXISTS "_cookieschema" ("strategy" VARCHAR(255) NOT NULL PRIMARY KEY, "fetch_date" DATETIME NOT NULL, "cookie_bytes" BLOB NOT NULL) WITHOUT ROWID', [])
2024-04-16 17:42:48,456 - DEBUG - ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2024-04-16 17:42:48,456 - DEBUG - loaded persistent cookie
2024-04-16 17:42:48,456 - DEBUG - reusing cookie
2024-04-16 17:42:48,488 - DEBUG - Starting new HTTPS connection (1): query1.finance.yahoo.com:443
2024-04-16 17:42:48,530 - DEBUG - https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2024-04-16 17:42:48,531 - DEBUG - crumb = '2ylVJsw6yG2'
2024-04-16 17:42:48,532 - DEBUG -      Exiting _get_cookie_and_crumb_basic()
2024-04-16 17:42:48,532 - DEBUG -     Exiting _get_cookie_and_crumb()
2024-04-16 17:42:48,537 - DEBUG - Starting new HTTPS connection (1): query2.finance.yahoo.com:443
2024-04-16 17:42:48,636 - DEBUG - https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/AAPL?period1=1577854800&period2=1704085200&interval=1d&includePrePost=False&events=div%2Csplits%2CcapitalGains&crumb=2ylVJsw6yG2 HTTP/1.1" 200 None
2024-04-16 17:42:48,652 - DEBUG - response code=200
2024-04-16 17:42:48,652 - DEBUG -    Exiting get()
2024-04-16 17:42:48,663 - DEBUG - AAPL: yfinance received OHLC data: 2020-01-02 14:30:00 -> 2023-12-29 14:30:00
2024-04-16 17:42:48,666 - DEBUG - AAPL: OHLC after cleaning: 2020-01-02 09:30:00-05:00 -> 2023-12-29 09:30:00-05:00
2024-04-16 17:42:48,691 - DEBUG - AAPL: OHLC after combining events: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:42:48,695 - DEBUG - AAPL: yfinance returning OHLC: 2020-01-02 00:00:00-05:00 -> 2023-12-29 00:00:00-05:00
2024-04-16 17:42:48,696 - DEBUG -   Exiting history()
2024-04-16 17:42:48,696 - DEBUG -  Exiting history()
2024-04-16 17:42:48,696 - DEBUG - Exiting download()
2024-04-16 17:42:48,696 - INFO - Swapping 'Adj Close' data into 'Close' column...
2024-04-16 17:42:48,696 - INFO - Removing 'Adj Close' column...
2024-04-16 17:42:48,697 - INFO - First few rows of the dataframe:
2024-04-16 17:42:48,697 - INFO -                  Open       High        Low      Close     Volume
Date                                                             
2020-01-02  74.059998  75.150002  73.797501  73.059425  135480400
2020-01-03  74.287498  75.144997  74.125000  72.349136  146322800
2020-01-06  73.447502  74.989998  73.187500  72.925629  118387200
2020-01-07  74.959999  75.224998  74.370003  72.582649  108872000
2020-01-08  74.290001  76.110001  74.290001  73.750237  132079200
2024-04-16 17:42:48,705 - INFO - Checking for missing values...
2024-04-16 17:42:48,706 - INFO - Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
2024-04-16 17:42:48,706 - INFO - Filling missing values, if any...
2024-04-16 17:42:48,707 - INFO - Calculating technical indicators...
2024-04-16 17:42:48,716 - INFO - Checking for NaN values after calculating technical indicators...
2024-04-16 17:42:48,717 - INFO - Open              0
High              0
Low               0
Close             0
Volume            0
SMA_10            9
SMA_50           49
EMA_20           19
RSI              14
STOCH_K          17
STOCH_D          17
MACD             33
MACDSIGNAL       33
MACDHIST         33
ADX              27
OBV               0
ATR              14
BBANDS_UPPER     19
BBANDS_MIDDLE    19
BBANDS_LOWER     19
MOM              10
CCI              13
WILLR            13
TSF              13
TRIX             88
ULTOSC           28
ROC              10
PLUS_DI          14
MINUS_DI         14
PLUS_DM          13
MINUS_DM         13
dtype: int64
2024-04-16 17:42:48,718 - INFO - Forward-filling NaN values...
2024-04-16 17:42:48,720 - INFO - Performing correlation analysis...
2024-04-16 17:42:48,723 - INFO - Correlation Matrix:
                  Close    Volume    SMA_10    SMA_50    EMA_20  ...       ROC   PLUS_DI  MINUS_DI   PLUS_DM  MINUS_DM
Close          1.000000 -0.556960  0.987863  0.940518  0.981609  ... -0.027869  0.382257  0.133783  0.188009 -0.003261
Volume        -0.556960  1.000000 -0.553656 -0.564787 -0.557995  ...  0.074886 -0.072355 -0.062147  0.226621  0.129785
SMA_10         0.987863 -0.553656  1.000000  0.960735  0.996117  ... -0.155270  0.292117  0.231659  0.113133  0.083568
SMA_50         0.940518 -0.564787  0.960735  1.000000  0.979613  ... -0.258417  0.121069  0.421796  0.009269  0.272974
EMA_20         0.981609 -0.557995  0.996117  0.979613  1.000000  ... -0.195204  0.241311  0.291564  0.080589  0.141583
RSI            0.030978  0.046877 -0.089781 -0.278496 -0.150260  ...  0.810861  0.736250 -0.897301  0.480139 -0.818051
STOCH_K        0.190154 -0.093407  0.071923 -0.036161  0.031390  ...  0.815903  0.713682 -0.638927  0.511783 -0.578090
STOCH_D        0.194849 -0.081934  0.095800 -0.034024  0.046450  ...  0.779372  0.708322 -0.629684  0.491952 -0.580167
MACD           0.084122  0.076523  0.019574 -0.245801 -0.062628  ...  0.598339  0.687358 -0.814082  0.458900 -0.778823
MACDSIGNAL     0.072951  0.108869  0.045970 -0.231208 -0.034415  ...  0.352576  0.562915 -0.699396  0.339619 -0.683674
MACDHIST       0.050137 -0.078290 -0.072848 -0.093895 -0.095318  ...  0.841353  0.506340 -0.504378  0.443557 -0.440066
ADX            0.083597  0.177829  0.064402 -0.075905  0.029548  ...  0.194501  0.360338 -0.386165  0.147314 -0.395610
OBV            0.747800 -0.318972  0.728020  0.665749  0.715246  ...  0.029925  0.298252  0.049478  0.277489 -0.003349
ATR           -0.206289  0.434361 -0.186273 -0.095743 -0.161115  ... -0.167338 -0.216498  0.370549  0.443536  0.685009
BBANDS_UPPER   0.967553 -0.514344  0.986220  0.974039  0.992123  ... -0.226627  0.233804  0.335402  0.118290  0.203381
BBANDS_MIDDLE  0.974566 -0.551469  0.993160  0.978086  0.998661  ... -0.229919  0.219648  0.310158  0.062538  0.158342
BBANDS_LOWER   0.967618 -0.581948  0.985864  0.968008  0.990868  ... -0.229980  0.201751  0.279432  0.003766  0.109289
MOM            0.067148 -0.002646 -0.063443 -0.169503 -0.103741  ...  0.977968  0.626802 -0.700528  0.498327 -0.632279
CCI            0.027230 -0.010088 -0.110643 -0.193513 -0.139451  ...  0.808442  0.603727 -0.728646  0.421371 -0.654291
WILLR          0.179111 -0.098426  0.046120 -0.036494  0.015400  ...  0.812659  0.673042 -0.604914  0.494691 -0.538150
TSF            0.993352 -0.551086  0.989063  0.929854  0.977454  ... -0.021692  0.386444  0.124772  0.186557 -0.013585
TRIX          -0.168298  0.401657 -0.164337 -0.332417 -0.202082  ...  0.057082  0.120964 -0.395388  0.067017 -0.342707
ULTOSC         0.513720 -0.235504  0.430679  0.408516  0.423125  ...  0.421387  0.691174 -0.108213  0.496215 -0.144546
ROC           -0.027869  0.074886 -0.155270 -0.258417 -0.195204  ...  1.000000  0.595362 -0.705479  0.480797 -0.635385
PLUS_DI        0.382257 -0.072355  0.292117  0.121069  0.241311  ...  0.595362  1.000000 -0.524262  0.760843 -0.502453
MINUS_DI       0.133783 -0.062147  0.231659  0.421796  0.291564  ... -0.705479 -0.524262  1.000000 -0.274478  0.917048
PLUS_DM        0.188009  0.226621  0.113133  0.009269  0.080589  ...  0.480797  0.760843 -0.274478  1.000000 -0.061485
MINUS_DM      -0.003261  0.129785  0.083568  0.272974  0.141583  ... -0.635385 -0.502453  0.917048 -0.061485  1.000000

[28 rows x 28 columns]
2024-04-16 17:42:48,746 - INFO - Selecting features based on correlation with the target variable...
2024-04-16 17:42:48,750 - INFO - Selected Features (Correlation): ['Volume', 'SMA_10', 'SMA_50', 'EMA_20', 'OBV', 'BBANDS_UPPER', 'BBANDS_MIDDLE', 'BBANDS_LOWER', 'TSF', 'ULTOSC']
2024-04-16 17:42:48,750 - INFO - Performing recursive feature elimination...
2024-04-16 17:42:48,773 - INFO - Selected Features (RFE): ['SMA_10', 'SMA_50', 'MACD', 'MACDSIGNAL', 'MACDHIST', 'ATR', 'BBANDS_MIDDLE', 'TSF', 'TRIX', 'MINUS_DM']
2024-04-16 17:42:48,773 - INFO - Updating selected features based on feature selection results...
2024-04-16 17:42:48,773 - INFO - Final Selected Features: ['Volume', 'BBANDS_LOWER', 'MINUS_DM', 'BBANDS_UPPER', 'Close', 'SMA_10', 'TRIX', 'SMA_50', 'MACD', 'BBANDS_MIDDLE', 'ULTOSC', 'OBV', 'EMA_20', 'MACDHIST', 'ATR', 'MACDSIGNAL', 'TSF']
2024-04-16 17:42:48,773 - INFO - Feature Importances (SelectKBest):
2024-04-16 17:42:48,773 - INFO - Volume: 411.9298653375638
2024-04-16 17:42:48,773 - INFO - SMA_10: 37048.7440790565
2024-04-16 17:42:48,773 - INFO - SMA_50: 7019.785952092146
2024-04-16 17:42:48,773 - INFO - EMA_20: 24218.392129034044
2024-04-16 17:42:48,773 - INFO - OBV: 0.8798808014070959
2024-04-16 17:42:48,773 - INFO - BBANDS_UPPER: 34.36370896755786
2024-04-16 17:42:48,773 - INFO - BBANDS_MIDDLE: 36.14955086305621
2024-04-16 17:42:48,773 - INFO - BBANDS_LOWER: 6.528328612560997
2024-04-16 17:42:48,773 - INFO - TSF: 4.900947683263723
2024-04-16 17:42:48,774 - INFO - ULTOSC: 2.3083939382808367
2024-04-16 17:42:48,774 - INFO - Feature Importances (RFE):
2024-04-16 17:42:48,774 - INFO - SMA_10: 17
2024-04-16 17:42:48,774 - INFO - SMA_50: 1
2024-04-16 17:42:48,774 - INFO - MACD: 1
2024-04-16 17:42:48,774 - INFO - MACDSIGNAL: 2
2024-04-16 17:42:48,774 - INFO - MACDHIST: 4
2024-04-16 17:42:48,774 - INFO - ATR: 10
2024-04-16 17:42:48,774 - INFO - BBANDS_MIDDLE: 16
2024-04-16 17:42:48,774 - INFO - TSF: 1
2024-04-16 17:42:48,774 - INFO - TRIX: 1
2024-04-16 17:42:48,774 - INFO - MINUS_DM: 1
2024-04-16 17:42:48,774 - INFO - Defining the scaler...
2024-04-16 17:42:48,774 - INFO - Scaling the selected features...
2024-04-16 17:42:48,778 - INFO - Preparing the data for training...
